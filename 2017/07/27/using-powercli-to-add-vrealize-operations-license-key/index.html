<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Using PowerCLI to Add vRealize Operations License Key &middot; davidstamen.com</title>
    <meta name="generator" content="Hugo 0.31.1" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="David Stamen">
    
      <meta name="description" content="a blog about virtualization and stuff">
    
    
    <link rel="canonical" href="http://davidstamen.com/2017/07/27/using-powercli-to-add-vrealize-operations-license-key/"/>
    <link rel="icon" href="http://davidstamen.com/favicon.ico">
    <link rel="apple-touch-icon" href="http://davidstamen.com/apple-touch-icon.png"/>
    <link rel="stylesheet" href="http://davidstamen.com/css/style.css">
    <link rel="stylesheet" href="http://davidstamen.com/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://davidstamen.com/css/monokai.css">
    <link rel="stylesheet" href="http://davidstamen.com/fancybox/jquery.fancybox.css">
    
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta property="og:title" content="Using PowerCLI to Add vRealize Operations License Key" />
<meta property="og:description" content="I have been working on doing a vCenter Consolidation Project. This included migrating our systems to a new vRealize Operations Server. This particular one included 73 different vSOM keys, and as you may know there is currently no way to enter in multiple keys at a time. I reached out to Kyle Ruddy and he informed me there is an API to do this, and that started my adventure to get this working." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://davidstamen.com/2017/07/27/using-powercli-to-add-vrealize-operations-license-key/" />



<meta property="article:published_time" content="2017-07-27T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2017-07-27T00:00:00&#43;00:00"/>











    
    
<meta itemprop="name" content="Using PowerCLI to Add vRealize Operations License Key">
<meta itemprop="description" content="I have been working on doing a vCenter Consolidation Project. This included migrating our systems to a new vRealize Operations Server. This particular one included 73 different vSOM keys, and as you may know there is currently no way to enter in multiple keys at a time. I reached out to Kyle Ruddy and he informed me there is an API to do this, and that started my adventure to get this working.">


<meta itemprop="datePublished" content="2017-07-27T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2017-07-27T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="324">



<meta itemprop="keywords" content="vROPS,PowerCLI," />

    <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Using PowerCLI to Add vRealize Operations License Key"/>
<meta name="twitter:description" content="I have been working on doing a vCenter Consolidation Project. This included migrating our systems to a new vRealize Operations Server. This particular one included 73 different vSOM keys, and as you may know there is currently no way to enter in multiple keys at a time. I reached out to Kyle Ruddy and he informed me there is an API to do this, and that started my adventure to get this working."/>
<meta name="twitter:site" content="@davidstamen"/>

    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
<div class="container">


<div id="container">
	<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="http://davidstamen.com/" id="logo">
          
          <i class="logo" style="background-image: url('http://davidstamen.com/images/apple-touch-icon-57x57.png')"></i>
          
          <span class="site-title">davidstamen.com</span>
      </a>
      <nav id="main-nav">
          

          
          <a class="main-nav-link" href="/">Home</a>
          
          <a class="main-nav-link" href="/resources/">Resources</a>
          
          <a class="main-nav-link" href="/acclaim/">Acclaim</a>
          

          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="http://davidstamen.com/images/apple-touch-icon-57x57.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" class="search-form-input" placeholder="Search">
              <button type="submit" class="search-form-submit">
              </button>
              <input type="hidden" name="sitesearch" value="http://davidstamen.com/" />
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          

          
          <td><a class="main-nav-link" href="/">Home</a></td>
          
          <td><a class="main-nav-link" href="/resources/">Resources</a></td>
          
          <td><a class="main-nav-link" href="/acclaim/">Acclaim</a></td>
          

          
          <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" class="search-form-input" placeholder="Search">
          <input type="hidden" name="sitesearch" value="http://davidstamen.com/" />
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>

   	
   	<div class="outer">
   	
    	<aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      
      <img id="avatar" src="https://www.gravatar.com/avatar/2051e99107a154b541623e5dd75293d3?s=100&d=identicon"/>
      
      <h2 id="name">David Stamen</h2>
      <h3 id="title">Blogger | Sr. Systems Engineer | Dad</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Kissimmee, FL</span>
      
          <a id="follow" href="https://twitter.com/davidstamen">
              Follow
          </a>
      
    </div>
    
    <div class="profile-block social-links">
      <table>
        <tr>
          
<td><a href="//github.com/dstamen" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>





































<td><a href="//linkedin.com/in/davidstamen" target="_blank" title="LinkedIn"><i class="fa fa-linkedin"></i></a></td>











<td><a href="//plus.google.com/+DavidStamen" target="_blank" title="Google+"><i class="fa fa-google-plus"></i></a></td>





<td><a href="//twitter.com/davidstamen" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="http://davidstamen.com/index.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>
</aside>

    

    <section id="main">
    
    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        

        <header class="article-header">
    <a href="http://davidstamen.com/2017/07/27/using-powercli-to-add-vrealize-operations-license-key/">
    <h1 class="article-title" itemprop="name">
        Using PowerCLI to Add vRealize Operations License Key
    </h1>
    </a>
    <div class="article-meta">

        
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2017-07-27 00:00:00 &#43;0000 UTC" itemprop="datePublished">07.27.2017</time>
        </div>
        
        

        
            
            
            <div class="article-category">
                <i class="fa fa-tags"></i>
                
                
                <a class="article-category-link" href="http://davidstamen.com/tags/vrops">vROPS</a>
                &middot;
                
                
                <a class="article-category-link" href="http://davidstamen.com/tags/powercli">PowerCLI</a>
                
                
            </div>
            
        
    </div>
</header>

        <div class="article-entry" itemprop="articleBody">
            

<p>I have been working on doing a vCenter Consolidation Project. This included migrating our systems to a new vRealize Operations Server. This particular one included 73 different vSOM keys, and as you may know there is currently no way to enter in multiple keys at a time. I reached out to Kyle Ruddy and he informed me there is an API to do this, and that started my adventure to get this working.</p>

<h4 id="pre-requsites"><strong><em>Pre-Requsites</em></strong></h4>

<ul>
<li><a href="https://www.vmware.com/support/developer/PowerCLI/">VMware PowerCLI</a></li>
</ul>

<h4 id="preparing-to-execute-the-script"><strong><em>Preparing to Execute the Script</em></strong></h4>

<p>The script is pretty straight forward, you can either export the license keys from an old vRealize Operations Server (6.6+) or create a CSV with column (LicenseKey) to be imported.</p>

<p>If you are choosing to export keys from an existing server, it has to be on a version that currently has API support. (I used v6.6)</p>

<p>You can run the following script to export all keys to a csv file.</p>

<pre><code>$Cred = Get-Credential
$vrom = &quot;vromold.lab.local&quot;

Connect-OMServer -Server $vrom -Credential $Cred

$omServer = $global:DefaultOMServers[0].ExtensionData
$omLicense = $OmServer.GetLicenseKeysForProduct()
$omLicense.Solutionlicense|Export-Csv C:\temp\omkeys2.csv -NoTypeInformation
</code></pre>

<p>If you exported the keys above, you should be immediately ready to import the keys to your new vRealize Operations Server, if not you can manually create the csv as listed above.</p>

<pre><code>$Cred = Get-Credential
$vrom = &quot;vromnew.lab.local&quot;

Connect-OMServer -Server $vrom -Credential $Cred

$keys = import-csv c:\temp\omkeys.csv
foreach ($key in $keys) {
    $solutionLicense = New-Object VMware.VimAutomation.VROps.Views.SolutionLicense
    $solutionLicense.LicenseKey = $key.LicenseKey
    $solutionLicenses = New-Object VMware.VimAutomation.VROps.Views.SolutionLicenses
    $solutionLicenses.Solutionlicense = $solutionLicense
    $omserver.AddLicenseKeyToProduct($solutionLicenses)
}
</code></pre>

<p>The documentation was pretty spotty on this as it stated you only needed to pass the key to AddLicenseKeyToProduct(), but after multiple tests I realized that was not true. I eventually found out i have to create SolutionLicense objects and link them till i got the proper format. This was quite fun as i learned alot about PowerShell and API documentation in this process.</p>

<p>You can find API documentation for vRealize Operations at <a href="https://fqdn/suite-api/docs/rest/index.html">https://fqdn/suite-api/docs/rest/index.html</a></p>

<p><img src="/images/vrom1.png" alt="" /></p>

<p>Hope this helps you out, leave any feedback or questions below.</p>

        </div>
        <footer class="article-footer">
    <a data-url="http://davidstamen.com/2017/07/27/using-powercli-to-add-vrealize-operations-license-key/" data-id="12683d7369228f2c1ebd316683a30938" class="article-share-link">
        <i class="fa fa-share"></i>
        Share
    </a>
    
    <a href="http://davidstamen.com/2017/07/27/using-powercli-to-add-vrealize-operations-license-key/#disqus_thread" class="article-comment-link">
        Comments
    </a>
    

    <script>
    (function ($) {
        
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="//twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="//www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="//plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                            '<a href="//www.linkedin.com/shareArticle?url=' + encodedUrl + '" class="fa fa-linkedin article-share-facebook target="_blank" title="LinkedIn+"></a>',
                            '<a href="//reddit.com/submit?url=' + encodedUrl + '" class="fa fa-reddit article-share-google target="_blank" title="Reddit"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
    </script>
</footer>

    </div>

    
<nav id="article-nav">
    
    <a href="http://davidstamen.com/2017/04/25/configuring-unifi-controller-and-usg-for-l2tp-vpn/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Older
      </strong>
      <div class="article-nav-title">Configuring Unifi Controller and USG for L2TP VPN</div>
    </a>
    

    
    <a href="http://davidstamen.com/2017/07/31/another-new-blog-platform/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Newer
      </strong>
      <div class="article-nav-title">Another New Blog Platform</div>
    </a>
    
</nav>


</article>


<section id="comments">
    <div id="disqus_thread">
        <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "davidstamen" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
</section>


    </section>

   	
    	<aside id="sidebar">
    


<div class="widget-wrap">
    <h3 class="widget-title">
        Sponsors
    </h3>
    <div class="widget">
				<center>
					<a href="https://www.vembu.com/free-vm-backup?utm_source=davidstamen.com&utm_medium=Banner&utm_campaign=Free%20VM%20Backup" target="_blank"><img src="/images/vembu.gif" width="163" height="163" title="Vembu"></a>
			</center>
    </div>
</div>




    
<div class="widget-wrap">
    <h3 class="widget-title">
        Recents
    </h3>
    <div class="widget">
        
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/01/02/using-forestry.io-to-manage-your-hugo-blog/" class="title">Using Forestry.io to Manage Your Hugo Blog</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/12/21/vcap6.5-dcv-design-experience/" class="title">VCAP6.5-DCV Design Experience</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/08/24/my-new-desk-by-standdesk/" class="title">My New Desk by StandDesk</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/08/vra-73-using-active-directory-policies/" class="title">vRA 7.3 - Using Active Directory Policies</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/08/02/vcenter-6.5u1-update-issues-with-vcha-advanced-deployment/" class="title">vCenter 6.5U1 Update Issues with VCHA Advanced Deployment</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/07/31/another-new-blog-platform/" class="title">Another New Blog Platform</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/07/27/using-powercli-to-add-vrealize-operations-license-key/" class="title">Using PowerCLI to Add vRealize Operations License Key</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/04/25/configuring-unifi-controller-and-usg-for-l2tp-vpn/" class="title">Configuring Unifi Controller and USG for L2TP VPN</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/04/17/using-powercli-to-set-vcenter-permissions-on-datacenter/" class="title">Using PowerCLI to Set vCenter Permissions on Datacenter</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2017/02/08/vexpert-2017/" class="title">vExpert 2017</a></p><br>
                
            
            
        
    </div>
</div>


    

    

    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tags
    </h3>
    <div class="widget tagcloud">
        
        
        <a href="http://davidstamen.com/tags/ansible" style="font-size: 12px;">ansible</a>
        
        
        <a href="http://davidstamen.com/tags/certification" style="font-size: 12px;">certification</a>
        
        
        <a href="http://davidstamen.com/tags/cisco" style="font-size: 12px;">cisco</a>
        
        
        <a href="http://davidstamen.com/tags/homelab" style="font-size: 12px;">homelab</a>
        
        
        <a href="http://davidstamen.com/tags/horizon-view" style="font-size: 12px;">horizon-view</a>
        
        
        <a href="http://davidstamen.com/tags/hugo" style="font-size: 12px;">hugo</a>
        
        
        <a href="http://davidstamen.com/tags/jekyll" style="font-size: 12px;">jekyll</a>
        
        
        <a href="http://davidstamen.com/tags/messaging" style="font-size: 12px;">messaging</a>
        
        
        <a href="http://davidstamen.com/tags/pernixdata" style="font-size: 12px;">pernixdata</a>
        
        
        <a href="http://davidstamen.com/tags/powercli" style="font-size: 12px;">powercli</a>
        
        
        <a href="http://davidstamen.com/tags/powerdns" style="font-size: 12px;">powerdns</a>
        
        
        <a href="http://davidstamen.com/tags/purestorage" style="font-size: 12px;">purestorage</a>
        
        
        <a href="http://davidstamen.com/tags/ravello" style="font-size: 12px;">ravello</a>
        
        
        <a href="http://davidstamen.com/tags/srm" style="font-size: 12px;">srm</a>
        
        
        <a href="http://davidstamen.com/tags/standdesk" style="font-size: 12px;">standdesk</a>
        
        
        <a href="http://davidstamen.com/tags/trend-micro" style="font-size: 12px;">trend-micro</a>
        
        
        <a href="http://davidstamen.com/tags/ubiquiti" style="font-size: 12px;">ubiquiti</a>
        
        
        <a href="http://davidstamen.com/tags/vagrant" style="font-size: 12px;">vagrant</a>
        
        
        <a href="http://davidstamen.com/tags/vcenter" style="font-size: 12px;">vcenter</a>
        
        
        <a href="http://davidstamen.com/tags/vcloud-air" style="font-size: 12px;">vcloud-air</a>
        
        
        <a href="http://davidstamen.com/tags/vdp" style="font-size: 12px;">vdp</a>
        
        
        <a href="http://davidstamen.com/tags/veeam" style="font-size: 12px;">veeam</a>
        
        
        <a href="http://davidstamen.com/tags/vexpert" style="font-size: 12px;">vexpert</a>
        
        
        <a href="http://davidstamen.com/tags/vmware" style="font-size: 12px;">vmware</a>
        
        
        <a href="http://davidstamen.com/tags/vra" style="font-size: 12px;">vra</a>
        
        
        <a href="http://davidstamen.com/tags/vrops" style="font-size: 12px;">vrops</a>
        
        
        <a href="http://davidstamen.com/tags/windows" style="font-size: 12px;">windows</a>
        
    </div>
</div>




    
</aside>

    
	</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018
      davidstamen.com
    </div>
  </div>
</footer>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-67336507-1', 'auto');
ga('send', 'pageview');
</script>

<script src="http://davidstamen.com/fancybox/jquery.fancybox.pack.js"></script>
<script src="http://davidstamen.com/js/script.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>


<script>hljs.initHighlightingOnLoad();</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




</body>
</html>
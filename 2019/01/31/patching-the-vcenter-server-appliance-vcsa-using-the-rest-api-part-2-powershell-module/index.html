<!doctype html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class=no-js><!--<![endif]--><head><meta charset=utf-8><title>Patching the vCenter Server Appliance (VCSA) using the REST API - Part 2 (PowerCLI Module) &#183; davidstamen.com</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content="vSphere 6.7,REST API,vCenter Server,Powershell,"><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:article:published_time" content="2019-01-31T00:00:00Z"><meta property="og:article:modified_time" content="2019-01-31T00:00:00Z"><meta property="og:article:tag" content="vSphere 6.7"><meta property="og:article:tag" content="REST API"><meta property="og:article:tag" content="vCenter Server"><meta property="og:article:tag" content="Powershell"><meta property="og:title" content="Patching the vCenter Server Appliance (VCSA) using the REST API - Part 2 (PowerCLI Module)"><meta property="og:description" content="Previously I covered how to use the VCSA Installer to do a scripted upgrade and then I covered Patching the vCenter Server Appliance (VCSA) using the REST API - Part 1 (Postman Collection) However, after learning recently how to call API&rsquo;s from Powershell I thought to myself, why not write a Powershell Module for this?
Introduction Using tools such as Postman can make it utilizing API&rsquo;s a bit easier, but you still need to be familiar with a separate tool or UI."><meta property="og:type" content="article"><meta property="og:url" content="https://davidstamen.com/2019/01/31/patching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module/"><meta property="og:image" content="https://davidstamen.com/featured/powercli.png"><meta property="article:published_time" content="2019-01-31T00:00:00+00:00"><meta property="article:modified_time" content="2019-01-31T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://davidstamen.com/featured/powercli.png"><meta name=twitter:title content="Patching the vCenter Server Appliance (VCSA) using the REST API - Part 2 (PowerCLI Module)"><meta name=twitter:description content="Previously I covered how to use the VCSA Installer to do a scripted upgrade and then I covered Patching the vCenter Server Appliance (VCSA) using the REST API - Part 1 (Postman Collection) However, after learning recently how to call API&rsquo;s from Powershell I thought to myself, why not write a Powershell Module for this?
Introduction Using tools such as Postman can make it utilizing API&rsquo;s a bit easier, but you still need to be familiar with a separate tool or UI."><meta name=twitter:site content="@davidstamen"><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-67336507-1','auto');ga('send','pageview');}</script><link rel=canonical href=https://davidstamen.com/2019/01/31/patching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module/><link rel=apple-touch-icon-precomposed sizes=144x144 href=/touch-icon-144-precomposed.png><link rel=icon href=/favicon/favicon.ico><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6907288179836979",enable_page_level_ads:true});</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/js/clr-3.0/clr-icons.min.js></script><script src=/js/clr-3.0/custom-elements.min.js></script><link href=/css/clr-3.0/clr-ui.css rel=stylesheet><link href=/css/clr-3.0/clr-icons.min.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><link rel=stylesheet href=/css/all.css></head><body data-ng-app=myapp data-ng-controller=MyController data-ng-mouseleave=MouseLeave($event)><div class=main-container><header class=header-2><div class=branding><a class=navbar-brand-img href=/><img alt src>
<span class=title>davidstamen.com</span></a></div><div class=header-nav [clr-nav-level]=1><a class="nav-link nav-text" href=https://davidstamen.com/ title=Home>Home</a>
<a class="nav-link nav-text" href=https://davidstamen.com/categories/pure-storage/ title="Pure Storage">Pure Storage</a>
<a class="nav-link nav-text" href=https://davidstamen.com/categories/vmware/ title=VMware>VMware</a>
<a class="nav-link nav-text" href=https://davidstamen.com/tags/ title=Tags>Tags</a>
<a class="nav-link nav-text" href=https://davidstamen.com/series/ title=Series>Series</a>
<a class="nav-link nav-text" href=https://www.youracclaim.com/users/davidstamen title=Acclaim>Acclaim</a>
<a class="nav-link nav-text" href=https://davidstamen.com/about title=About>About</a></div><div class=header-actions><form class=search id=search method=get action=//google.com/search><label for=search_input><input id=search_input type=text name=q placeholder=Search>
<input type=hidden name=as_sitesearch value=davidstamen.com></label></form></div></header><div class=content-container><div class=content-area><h1>Patching the vCenter Server Appliance (VCSA) using the REST API - Part 2 (PowerCLI Module)</h1><div class=metas><span class=clr-card-authors><div class=clr-card-authors>Published on
January 31, 2019 under <a href=/categories/vmware>VMware</a>
&#183; Tagged <a href=/tags/vsphere-6.7>vSphere 6.7</a>, <a href=/tags/rest-api>REST API</a>, <a href=/tags/vcenter-server>vCenter Server</a> and <a href=/tags/powershell>Powershell</a>
&#183; Read in about 5 min (937 words)</div></span></div><hr><p>Previously I covered how to use the
<a href="https://blogs.vmware.com/vsphere/2018/09/upgrading-platform-services-controller-and-vcenter-server-via-the-cli-installer.html?cid=70134000001kxaB&src=so_5c783ca7348a0" target=_blank>VCSA Installer to do a scripted upgrade</a> and then I covered
<a href=https://davidstamen.com/2018/12/20/patching-the-vcenter-server-appliance-vcsa-using-the-rest-api/ target=_blank>Patching the vCenter Server Appliance (VCSA) using the REST API - Part 1 (Postman Collection)</a> However, after learning recently how to call API&rsquo;s from Powershell I thought to myself, why not write a Powershell Module for this?</p><h1 id=introduction>Introduction</h1><p>Using tools such as
<a href=https://www.getpostman.com/ target=_blank>Postman</a> can make it utilizing API&rsquo;s a bit easier, but you still need to be familiar with a separate tool or UI. I was able to develop my own version and build my first Powershell Module that you can use to patch the VCSA in a simple method. Some of the function names below may not be 100% exact and this is due to the accepted verbs for Powershell. If you have further recommendations I would be happy to entertain changing the Powershell verbage.</p><h1 id=use-cases>Use Cases</h1><p>Why would you want to use a Powershell module such as this? Well this tool can support multiple vCenter Servers. So here are a few ideas.</p><ul><li>Modify a Custom URL Repository Across all vCenter Servers in your Environment</li><li>Stage Patches across all vCenter Servers in your Environment.</li><li>Patch Multiple Servers Simultaneously</li></ul><h1 id=exploring-the-powershell-module-functions>Exploring the Powershell Module Functions</h1><p>As of current, the Powershell module currently has 12 Functions.</p><ul><li>Copy-VCSAUpdate</li><li>Get-VCSAUpdate</li><li>Get-VCSAUpdateDetail</li><li>Get-VCSAUpdatePolicy</li><li>Set-VCSAUpdatePolicy</li><li>Get-VCSAUpdateStaged</li><li>Get-VCSAUpdateStatus</li><li>Remove-VCSAUpdate</li><li>Start-VCSAUpdateInstall</li><li>Start-VCSAUpdatePrecheck</li><li>Start-VCSAUpdateStageandInstall</li><li>Start-VCSAUpdateValidate</li><li>Stop-VCSAUpdate</li></ul><h3 id=copy-vcsaupdate>Copy-VCSAUpdate</h3><p>Copy-VCSAUpdate is the command you will use when you want to manually stage the update.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Copy-VCSAUpdate</span> -Version <span style=color:#f1fa8c>&#34;6.7.0.20100&#34;</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/copyvcsaupdate.png data-caption><img width=100% src=/images/copyvcsaupdate.png></a></div><h3 id=get-vcsaupdate>Get-VCSAUpdate</h3><p>Get-VCSAUpdate is the command you will use when you want to wish to check for new updates. There is an optional Parameter for Source, &ldquo;Local&rdquo; or &ldquo;Online&rdquo;, if no parameter is chosen it will default to Online.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Get-VCSAUpdate</span>

<span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Get-VCSAUpdate</span> -Source <span style=color:#f1fa8c>&#34;Online&#34;</span>

<span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Get-VCSAUpdate</span> -Source <span style=color:#f1fa8c>&#34;Local&#34;</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/getvcsaupdate.png data-caption><img width=100% src=/images/getvcsaupdate.png></a></div><h3 id=get-vcsaupdatedetail>Get-VCSAUpdateDetail</h3><p>Get-VCSAUpdateDetail is the command you will use when you want to wish to get more details about a specific update. There is a mandatory parameter for Version.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Get-VCSAUpdateDetail</span> -Version <span style=color:#f1fa8c>&#34;6.7.0.20100&#34;</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/getvcsaupdatedetail.png data-caption><img width=100% src=/images/getvcsaupdatedetail.png></a></div><h3 id=get-vcsaupdatepolicy>Get-VCSAUpdatePolicy</h3><p>Get-VCSAUpdatePolicy is the command you will use when you want to wish to get information about the current appliance update settings.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Get-VCSAUpdatePolicy</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/getvcsaupdatepolicy.png data-caption><img width=100% src=/images/getvcsaupdatepolicy.png></a></div><h3 id=set-vcsaupdatepolicy>Set-VCSAUpdatePolicy</h3><p>Set-VCSAUpdatePolicy is the command you will use when you want to wish to set information for the current appliance update settings.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -AutoStage <span style=color:#8be9fd;font-style:italic>$True</span>

<span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CustomURL https://myinternalURL.com
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CustomURL <span style=color:#8be9fd;font-style:italic>Clear
</span><span style=color:#8be9fd;font-style:italic></span>
<span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -UsernameURL admin
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -PasswordURL Password

<span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CheckSchedule Daily
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CheckSchedule WeeklySunday
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CheckSchedule WeeklyMonday
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CheckSchedule WeeklyTuesday
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CheckSchedule WeeklyWednesday
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CheckSchedule WeeklyThursday
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CheckSchedule WeeklyFriday
<span style=color:#8be9fd;font-style:italic>Set-VCSAUpdatePolicy</span> -CheckSchedule WeeklySaturday
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/setvcsaupdatepolicy.png data-caption><img width=100% src=/images/setvcsaupdatepolicy.png></a></div><h3 id=get-vcsaupdatestaged>Get-VCSAUpdateStaged</h3><p>Get-VCSAUpdateStaged is the command you will use when you want to wish to get information about the current staged update.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Get-VCSAUpdateStaged</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/getvcsaupdatestaged.png data-caption><img width=100% src=/images/getvcsaupdatestaged.png></a></div><h3 id=get-vcsaupdatestatus>Get-VCSAUpdateStatus</h3><p>Get-VCSAUpdateStaged is the command you will use when you want to wish to get information about the current update status. This command can be used to get status of staged update, install update or any other update status.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Get-VCSAUpdateStatus</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/getvcsaupdatestatus.png data-caption><img width=100% src=/images/getvcsaupdatestatus.png></a></div><h3 id=remove-vcsaupdate>Remove-VCSAUpdate</h3><p>Remove-VCSAUpdate is the command you will use when you wish to remove a staged update.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Remove-VCSAUpdate</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/removevcsaupdate.png data-caption><img width=100% src=/images/removevcsaupdate.png></a></div><h3 id=start-vcsaupdateinstall>Start-VCSAUpdateInstall</h3><p>Start-VCSAUpdateInstall is the command you will use when you wish to install a currently staged update. If no update is staged you must use <code>Start-VCSAUpdateStageandInstall</code></p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Start-VCSAUpdateInstall</span> -Version <span style=color:#f1fa8c>&#34;6.7.0.20100&#34;</span> -SSODomainPass <span style=color:#f1fa8c>&#34;VMware1!&#34;</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/startvcsaupdateinstall.png data-caption><img width=100% src=/images/startvcsaupdateinstall.png></a></div><h3 id=start-vcsaupdateprecheck>Start-VCSAUpdatePrecheck</h3><p>Start-VCSAUpdatePrecheck is the command you will use when you wish to run the built-in update Precheck.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Start-VCSAUpdatePrecheck</span> -Version <span style=color:#f1fa8c>&#34;6.7.0.20100&#34;</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/startvcsaupdateprecheck.png data-caption><img width=100% src=/images/startvcsaupdateprecheck.png></a></div><h3 id=start-vcsaupdatestageandinstall>Start-VCSAUpdateStageandInstall</h3><p>Start-VCSAUpdateInstall is the command you will use when you wish to install and stage an update.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Start-VCSAUpdateStageandInstall</span> -Version <span style=color:#f1fa8c>&#34;6.7.0.20100&#34;</span> -SSODomainPass <span style=color:#f1fa8c>&#34;VMware1!&#34;</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/startvcsaupdatestageandinstall.png data-caption><img width=100% src=/images/startvcsaupdatestageandinstall.png></a></div><h3 id=start-vcsaupdatevalidate>Start-VCSAUpdateValidate</h3><p>Start-VCSAUpdateValidate is the command you will use when you wish validate the current update.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Start-VCSAUpdateValidate</span> -Version <span style=color:#f1fa8c>&#34;6.7.0.20100&#34;</span> -SSODomainPass <span style=color:#f1fa8c>&#34;VMware1!&#34;</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/startvcsaupdatevalidate.png data-caption><img width=100% src=/images/startvcsaupdatevalidate.png></a></div><h3 id=stop-vcsaupdate>Stop-VCSAUpdate</h3><p>Stop-VCSAUpdate is the command you will use when you want to cancel an update task such as staging an update or other task that has a status of cancelable.</p><p><strong>Example:</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-posh data-lang=posh><span style=color:#8be9fd;font-style:italic>Connect-CisServer</span> -Server 192.168.1.51 -User administrator<span style=color:#8be9fd;font-style:italic>@vsphere</span>.local -Password VMware1!
<span style=color:#8be9fd;font-style:italic>Stop-VCSAUpdate</span>
</code></pre></div><link rel=stylesheet href=/css/jquery.fancybox.min.css><script src=/js/jquery-3.4.1.min.js></script><script src=/js/jquery.fancybox.min.js></script><div style=max-width:80%;width:fit-content;margin:auto;padding:1.5em><a data-fancybox href=/images/stopvcsaupdate.png data-caption><img width=100% src=/images/stopvcsaupdate.png></a></div><h1 id=putting-the-powershell-module-to-use>Putting the Powershell Module to Use</h1><h6 id=this-examples-assumes-your-vcsa-has-internet-access-and-we-will-update-via-the-online-repo>This Examples assumes your VCSA has Internet Access and we will update via the Online Repo.</h6><p>You can access the Powershell Module
<a href=https://github.com/dstamen/Powershell/blob/master/VCSA-VAMI-Patch.psm1 target=_blank>here on GitHub</a>.</p><blockquote><p><strong>Important Note:</strong> The code samples included in this module are
not supported by VMware. The code included is only provided as
sample code for the purpose of demonstrating different tasks using
the PowerCLI and the REST API.</p></blockquote><ol><li>Import the module<ul><li><code>Import-Module .\VCSA-VAMI-Patch.psm1</code></li></ul></li><li>Check for Updates<ul><li><code>Get-VCSAUpdate</code></li></ul></li><li>Stage Update and Check Status<ul><li><code>Copy-VCSAUpdate -Version "6.7.0.20100"</code> and <code>Get-VCSAUpdateStatus</code> until status shows <code>UPDATE_PENDING</code></li></ul></li><li>Run Update Precheck and Validate<ul><li><code>Start-VCSAUpdatePrecheck -Version 6.7.0.20100</code> and <code>Start-VCSAUpdateValidate -Version 6.7.0.20100 -SSODomainPass VMware1!</code></li><li>If no errors, proceed with Install</li></ul></li><li>Run Update Install<ul><li><code>Start-VCSAUpdateInstall -Version 6.7.0.20100 -SSODomainPass VMware1!</code> and <code>Get-VCSAUpdateStatus</code> until you see status as <code>UPDATE_COMPLETE</code></li></ul></li><li>Validate Update Version in VCSA UI or in vSphere Client</li></ol><h1 id=conclusion>Conclusion</h1><p>I hope
<a href=https://github.com/dstamen/Powershell/blob/master/VCSA-VAMI-Patch.psm1 target=_blank>this module</a> can be useful for you to get started with updating your VCSA in a more Automated fashion. Big thanks to
<a href=https://twitter.com/stvkpln target=_blank>Steve Kaplan</a> for taking time to review the module and provide feedback and input!</p><p>If you have any questions feel free to reach out here or on twitter
<a href=https://twitter.com/davidstamen target=_blank>@davidstamen</a></p><h6>Share this post</h6><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fdavidstamen.com%2f2019%2f01%2f31%2fpatching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?text=Patching%20the%20vCenter%20Server%20Appliance%20%28VCSA%29%20using%20the%20REST%20API%20-%20Part%202%20%28PowerCLI%20Module%29&url=https%3a%2f%2fdavidstamen.com%2f2019%2f01%2f31%2fpatching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M23.44 4.83c-.8.37-1.5.38-2.22.02.93-.56.98-.96 1.32-2.02-.88.52-1.86.9-2.9 1.1-.82-.88-2-1.43-3.3-1.43-2.5.0-4.55 2.04-4.55 4.54.0.36.03.7.1 1.04-3.77-.2-7.12-2-9.36-4.75-.4.67-.6 1.45-.6 2.3.0 1.56.8 2.95 2 3.77-.74-.03-1.44-.23-2.05-.57v.06c0 2.2 1.56 4.03 3.64 4.44-.67.2-1.37.2-2.06.08.58 1.8 2.26 3.12 4.25 3.16C5.78 18.1 3.37 18.74 1 18.46c2 1.3 4.4 2.04 6.97 2.04 8.35.0 12.92-6.92 12.92-12.93.0-.2.0-.4-.02-.6.9-.63 1.96-1.22 2.56-2.14z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fdavidstamen.com%2f2019%2f01%2f31%2fpatching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module%2f&title=Patching%20the%20vCenter%20Server%20Appliance%20%28VCSA%29%20using%20the%20REST%20API%20-%20Part%202%20%28PowerCLI%20Module%29&summary=Patching%20the%20vCenter%20Server%20Appliance%20%28VCSA%29%20using%20the%20REST%20API%20-%20Part%202%20%28PowerCLI%20Module%29&source=https%3a%2f%2fdavidstamen.com%2f2019%2f01%2f31%2fpatching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module%2f" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.5 21.5h-5v-13h5v13zM4 6.5C2.5 6.5 1.5 5.3 1.5 4s1-2.4 2.5-2.4c1.6.0 2.5 1 2.6 2.5.0 1.4-1 2.5-2.6 2.5zm11.5 6c-1 0-2 1-2 2v7h-5v-13h5V10s1.6-1.5 4-1.5c3 0 5 2.2 5 6.3v6.7h-5v-7c0-1-1-2-2-2z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fdavidstamen.com%2f2019%2f01%2f31%2fpatching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module%2f&resubmit=true&title=Patching%20the%20vCenter%20Server%20Appliance%20%28VCSA%29%20using%20the%20REST%20API%20-%20Part%202%20%28PowerCLI%20Module%29" target=_blank rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96.0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65.0 3-1.35 3-3s-1.35-3-3-3c-1.38.0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65.0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66.0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64.0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4.0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6.0.23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1.0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1.0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Patching%20the%20vCenter%20Server%20Appliance%20%28VCSA%29%20using%20the%20REST%20API%20-%20Part%202%20%28PowerCLI%20Module%29&body=https%3a%2f%2fdavidstamen.com%2f2019%2f01%2f31%2fpatching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module%2f" target=_self rel=noopener aria-label><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg></div></div></a><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")
return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='davidstamen';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=http://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a><h3>See Also</h3><ul><li><a href=/2018/12/20/patching-the-vcenter-server-appliance-vcsa-using-the-rest-api/>Patching the vCenter Server Appliance (VCSA) using the REST API - Part 1 (Postman Collection)</a></li><li><a href=/2018/10/05/upgrading-platform-services-controller-and-vcenter-server-via-the-cli-installer/>Upgrading Platform Services Controller and vCenter Server via the CLI Installer</a></li><li><a href=/2018/05/23/patching-your-vcenter-server-appliance-from-6.7-to-6.7a/>Patching your vCenter Server Appliance from 6.7 to 6.7a</a></li><li><a href=/2018/04/17/upgrading-to-vmware-vsphere-6.7/>Upgrading to VMware vSphere 6.7</a></li><li><a href=/2018/11/19/upgrading-to-vmware-vsphere-6.7-ebook-now-available/>Upgrading to VMware vSphere 6.7 eBook - Now Available</a></li></ul><div class="clarity-prev-next col-xs-12 col-sm-12 col-md-12 col-lg-12"><nav class=clarity-page-prev-next><div class=clr-nav-previous><a href=https://davidstamen.com/2018/12/20/patching-the-vcenter-server-appliance-vcsa-using-the-rest-api/ title="Patching the vCenter Server Appliance (VCSA) using the REST API - Part 1 (Postman Collection)" class="btn btn-sm btn-outline">Previous</a></div><div class=clr-nav-next><a href=https://davidstamen.com/2019/04/11/vcenter-server-converge-tool-how-do-i-converge-an-environment-using-the-ui/ title="vCenter Server Converge Tool - How do I Converge an Environment Using the UI" class="btn btn-sm btn-outline">Next</a></div></nav></div></div><nav class="sidenav clr-col-2 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><section class=sidenav-content><div class=card><div class=card-block><div class=card-text id=site-intro><img src=/images/me2-300.png><p>a blog about virtualization and stuff<ul class=nav-list-inline><a href=//github.com/dstamen target=_blank rel=noopener title=GitHub class="fab fa-github"></a><a href=//linkedin.com/in/davidstamen target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a><a href=//twitter.com/davidstamen target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a><a href=mailto:dstamen@gmail.com target=_blank title=Email class="fas fa-envelope"></a></ul></div></div></div><div class=card><div class=card-header><b>Latest Posts</b></div><div class=card-block><div class=card-text><ul class=list style=list-style-type:square;list-style-position:inherit><li><a class=nav-list href=https://davidstamen.com/deploying-tkg-on-vsphere/>Deploying Tanzu Kubernetes Grid (TKG) on vSphere</a></li><li><a class=nav-list href=https://davidstamen.com/2020/04/24/whats-new-in-the-pure-storage-vrealize-operations-management-pack-3.0/>What's New in the Pure Storage vRealize Operations Management Pack 3.0</a></li><li><a class=nav-list href=https://davidstamen.com/2020/04/21/whats-new-in-the-4.3.0-pure-storage-vsphere-client-plugin/>What's New in the 4.3.0 Pure Storage vSphere Client Plugin</a></li><li><a class=nav-list href=https://davidstamen.com/2020/04/16/using-powercli-to-deploy-the-site-recovery-manager-8.3-appliance/>Using PowerCLI to Deploy the Site Recovery Manager 8.3 Appliance</a></li><li><a class=nav-list href=https://davidstamen.com/2020/04/13/part-6-deploying-vsphere-with-kubernetes-provisioning-and-managing-a-tanzu-kubernetes-cluster/>Part 6: Deploying vSphere with Kubernetes - Provisioning and Managing a Tanzu Kubernetes Cluster</a></li></ul></div></div></div><div class=card><div class=card-header><b>Advertisements</b></div><div class=card-block><div class=card-text align=center><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:inline-block;width:180px;height:150px data-ad-client=ca-pub-6907288179836979 data-ad-slot=6070718289></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div></div></section></nav></div></div></body></html>
<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>vSphere6 - Unable to use session credentials &#8211; davidstamen.com</title>
<meta name="description" content="So one thing I have come across with a few VCSA6 installs was the inability to use login with current credentials via the Web client or vSphere client.

">
<meta name="keywords" content="">



<!-- Twitter Cards -->
<meta name="twitter:title" content="vSphere6 - Unable to use session credentials">
<meta name="twitter:description" content="So one thing I have come across with a few VCSA6 installs was the inability to use login with current credentials via the Web client or vSphere client.

">
<meta name="twitter:site" content="@davidstamen">
<meta name="twitter:creator" content="@davidstamen">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="vSphere6 - Unable to use session credentials">
<meta property="og:description" content="So one thing I have come across with a few VCSA6 installs was the inability to use login with current credentials via the Web client or vSphere client.

">
<meta property="og:url" content="/vmware/vsphere6-unable-to-use-session-credentials/">
<meta property="og:site_name" content="davidstamen.com">

<meta property="og:image" content="/images/default-thumb.png">







<link rel="canonical" href="/vmware/vsphere6-unable-to-use-session-credentials/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="davidstamen.com Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons-->
<link rel="shortcut icon" href="/favicon.ico">
<link rel="shortcut icon" href="/favicon.png">
<link rel="icon" href="/favicon.ico">
<link rel="icon" href="/favicon.png">
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/images//apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images//apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images//apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images//apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images//apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images//apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images//apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images//apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images//apple-touch-icon-180x180.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">davidstamen.com</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/categories/" >Categories</a></li>
				
				    
				        
				    
				    <li><a href="/posts/" >Posts</a></li>
				
				    
				        
				    
				    <li><a href="/resources/" >Resources</a></li>
				
				    
				        
				    
				    <li><a href="/search/" >Search</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    


<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/me.jpeg" class="bio-photo" alt="David Stamen bio photo">

  <h4 itemprop="name">David Stamen</h4>
  <p>Senior Virtualization Engineer
  <br><br>VCAP-DCA | MCSA | VMware vExpert | Cisco Champion | PernixPro
</p>
  <a href="mailto:dstamen@gmail.com" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/davidstamen" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  
  <a href="http://linkedin.com/in/davidstamen" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  
  
  <a href="http://github.com/dstamen" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/vmware/vsphere6-unable-to-use-session-credentials/" rel="bookmark" title="vSphere6 - Unable to use session credentials">vSphere6 - Unable to use session credentials</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>So one thing I have come across with a few VCSA6 installs was the inability to use login with current credentials via the Web client or vSphere client.</p>

<p><img src="/images/Screen-Shot-2015-04-13-at-10.57.41-AM.png" alt="" /></p>

<p>Working with VMware support we were finally able to get it working with a few tweaks and there is a current pending KB that has not been published yet. (KB2113038) I have been told this affects both an embedded deployment (VCSA and PSC together) and external deployment (VCSA and PSC seperate.)</p>

<h3 id="if-using-an-embedded-vcsapsc-make-sure-the-vm-is-joined-to-the-domain-if-using-an-external-vcsa-and-psc-you-can-easily-join-the-psc-to-the-domain-using-the-vsphere-web-client">If using an embedded VCSA+PSC make sure the VM is joined to the domain. If using an external VCSA and PSC you can easily join the PSC to the domain using the vSphere Web Client.</h3>

<ol>
  <li>Log in to your vSphere Web Client.</li>
  <li>Navigate to Administration-&gt;System Configuration-&gt;Nodes</li>
  <li>Select your PSC and select the Active Directory Tab.
    <ul>
      <li>From here you can enter in your domain and credentials and join it to the domain, after it is successful you will need to restart the PSC.</li>
    </ul>
  </li>
</ol>

<p><img src="/images/Screen-Shot-2015-04-13-at-11.37.23-AM.png" alt="" /></p>

<h3 id="if-you-try-to-select-your-vcsa-and-look-for-the-active-directory-tab-you-will-notice-it-is-missing-to-join-your-vcsa-to-the-domain-you-need-to-perform-the-domain-join-via-the-cli">If you try to select your VCSA and look for the Active Directory tab you will notice it is missing, to join your VCSA to the domain you need to perform the domain join via the CLI.</h3>

<ol>
  <li>SSH to your VCSA</li>
  <li>Query the device to see if it is joined to the domain
    <ul>
      <li>/opt/likewise/bin/domainjoin-cli query
<img src="/images/Screen-Shot-2015-04-13-at-11.42.37-AM.png" alt="" /></li>
    </ul>
  </li>
  <li>Join the device to the domain using the following syntax, you will need to enter int he domainname, user with rights to join domain
    <ul>
      <li>/opt/likewise/bin/domainjoin-cli join domainname adminusername
<img src="/images/Screen-Shot-2015-04-13-at-11.43.31-AM.png" alt="" /></li>
    </ul>
  </li>
  <li>Once it is successful reboot the system and rerun the query to see if it was successfully joined
    <ul>
      <li>/opt/likewise/bin/domainjoin-cli query
<img src="/images/Screen-Shot-2015-04-13-at-11.43.45-AM.png" alt="" /></li>
    </ul>
  </li>
</ol>

<h3 id="at-this-point-if-you-try-to-login-with-the-current-credentials-you-will-still-fail-as-there-is-one-additional-step-this-will-need-to-be-completed-on-the-vcsa-virtual-machine">At this point if you try to login with the current credentials you will still fail as there is one additional step. This will need to be completed on the VCSA virtual machine.</h3>

<ol>
  <li>SSH to the appropriate appliance</li>
  <li>Navigate to /etc/ and using your favorite text editor modify the nsswitch.conf file. (Examples are using VI)</li>
  <li>Look for the line “password: compat ato” this line will need to be modified
<img src="/images/Screen-Shot-2015-04-13-at-11.01.00-AM.png" alt="" /></li>
  <li>
    <p>Modify the line to read “passwd: compat ato lsass”
<img src="/images/Screen-Shot-2015-04-13-at-11.02.20-AM.png" alt="" /></p>
  </li>
  <li>Once you have updated the file and saved it, restart the VCSA or its services
    <ul>
      <li>service vmware-vpxd restart</li>
    </ul>
  </li>
  <li>Now wait….in multiple tests it takes 30 minutes until you are able to logon using the credentials and it will now work for both the web and c# client.
    <ul>
      <li>In some cases this file will also need to be modified on the PSC.</li>
    </ul>
  </li>
</ol>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?url=/vmware/vsphere6-unable-to-use-session-credentials/&text=vSphere6 - Unable to use session credentials&via=davidstamen" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/vmware/vsphere6-unable-to-use-session-credentials/" class="tumbler" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/vmware/vsphere6-unable-to-use-session-credentials/" class="tumbler" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a>
    </li>
    <li>
      <a href="http://www.linkedin.com/shareArticle?mini=true&url=/vmware/vsphere6-unable-to-use-session-credentials/" class="tumbler" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin-square fa-2x"></i></a>
    </li>
    <li>
      <a href="http://www.reddit.com/submit?url=/vmware/vsphere6-unable-to-use-session-credentials/&title=vSphere6 - Unable to use session credentials" class="tumbler" title="Share on Reddit"><i class="fa fa-fw fa-reddit-square fa-2x"></i></a>
    </li>
  </ul>
</div><!-- /.social-share -->

        <p class="byline"><strong>vSphere6 - Unable to use session credentials</strong> was published on <time datetime="2015-04-13T00:00:00-04:00">April 13, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/vmware/vexpert-2016/" title="vExpert 2016">vExpert 2016</a></li>
    
      <li><a href="/ansible/using-ansible-to-run-powershell-scripts/" title="Using Ansible to Run Powershell Scripts">Using Ansible to Run Powershell Scripts</a></li>
    
      <li><a href="/ansible/cisco/using-ansible-to-create-cisco-aci-filters/" title="Using Ansible to Create Cisco ACI Filters">Using Ansible to Create Cisco ACI Filters</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2016 David Stamen. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a></span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-67336507-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'davidstamen'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




</body>
</html>

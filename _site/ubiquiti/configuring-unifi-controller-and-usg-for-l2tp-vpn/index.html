<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Configuring Unifi Controller and USG for L2TP VPN &#8211; davidstamen.com</title>
<meta name="description" content="I have been waiting for native GUI support for L2TP vpn with local users and it is finally here! Ubiquiti Unifi Equipment now supports local radius auth using the 5.5.x code of controller! Please see below on how you can get this setup. For my example i will be using the Stable Candidate 5.5.11.

">
<meta name="keywords" content="">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Configuring Unifi Controller and USG for L2TP VPN">
<meta name="twitter:description" content="I have been waiting for native GUI support for L2TP vpn with local users and it is finally here! Ubiquiti Unifi Equipment now supports local radius auth using the 5.5.x code of controller! Please see below on how you can get this setup. For my example i will be using the Stable Candidate 5.5.11.

">
<meta name="twitter:site" content="@davidstamen">
<meta name="twitter:creator" content="@davidstamen">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Configuring Unifi Controller and USG for L2TP VPN">
<meta property="og:description" content="I have been waiting for native GUI support for L2TP vpn with local users and it is finally here! Ubiquiti Unifi Equipment now supports local radius auth using the 5.5.x code of controller! Please see below on how you can get this setup. For my example i will be using the Stable Candidate 5.5.11.

">
<meta property="og:url" content="/ubiquiti/configuring-unifi-controller-and-usg-for-l2tp-vpn/">
<meta property="og:site_name" content="davidstamen.com">

<meta property="og:image" content="/images/default-thumb.png">







<link rel="canonical" href="/ubiquiti/configuring-unifi-controller-and-usg-for-l2tp-vpn/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="davidstamen.com Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons-->
<link rel="shortcut icon" href="/favicon.ico">
<link rel="shortcut icon" href="/favicon.png">
<link rel="icon" href="/favicon.ico">
<link rel="icon" href="/favicon.png">
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<link rel="apple-touch-icon" sizes="57x57" href="/images//apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images//apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images//apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images//apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images//apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images//apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images//apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images//apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images//apple-touch-icon-180x180.png">

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6907288179836979",
    enable_page_level_ads: true
  });
</script>

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">davidstamen.com</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				    <li><a href="/categories/" >Categories</a></li>
				
				    
				    <li><a href="/posts/" >Posts</a></li>
				
				    
				    <li><a href="/resources/" >Resources</a></li>
				
				    
				    <li><a href="/acclaim/" >Acclaim</a></li>
				
				    
				    <li><a href="/search/" >Search</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/me.jpeg" class="bio-photo" alt="David Stamen bio photo">

  <h4 itemprop="name">David Stamen</h4>
  <p>Senior Virtualization Engineer
  <br><br>VCAP-DCA | MCSA | VMware vExpert
</p>
  <a href="mailto:dstamen@gmail.com" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/davidstamen" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  
  <a href="http://linkedin.com/in/davidstamen" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  
  
  <a href="http://github.com/dstamen" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  
  
  
  
</div>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6907288179836979",
    enable_page_level_ads: true
  });
</script>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/ubiquiti/configuring-unifi-controller-and-usg-for-l2tp-vpn/" rel="bookmark" title="Configuring Unifi Controller and USG for L2TP VPN">Configuring Unifi Controller and USG for L2TP VPN</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>I have been waiting for native GUI support for L2TP vpn with local users and it is finally here! Ubiquiti Unifi Equipment now supports local radius auth using the 5.5.x code of controller! Please see below on how you can get this setup. For my example i will be using the Stable Candidate 5.5.11.</p>

<p><a href="https://community.ubnt.com/t5/UniFi-Updates-Blog/UniFi-5-5-11-Stable-Candidate-has-been-released/ba-p/1905832">Unifi Controller 5.5.11</a></p>

<p>Configuration is quite simple! Just follow these few easy steps and you will be up in no time.</p>

<ul>
  <li>The first step is to create your radius profile. to do this browse to <em>Settings</em> and then <em>Profiles</em>.</li>
  <li>Here you will create a name for your radius profile, the only thing you will change here is the <em>IP Address</em> of your USG and then set the <em>Password/Pre Shared Secret</em>. When done hit save.</li>
</ul>

<p><img src="/images/vpnradiusprofile.png" alt="" /></p>

<ul>
  <li>Next up on the configuration is the Radius Service Configuration. Browse to <em>Settings</em> and <em>Services</em>.
    <ul>
      <li>First up is the user, select Users and then enter in the following details.
        <ul>
          <li>Name: username</li>
          <li>Password: password to be used for client conenctivity</li>
          <li>VLAN: leave blank</li>
          <li>Tunnel Type: 3 (For L2TP)</li>
          <li>Tunnel Medium Type: 1 (For IPv4)</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="/images/vpnradiususers.png" alt="" /></p>

<ul>
  <li>Next up on the Radius Service configuration is the <em>Server</em> Configuration.
    <ul>
      <li>Click on Server under Servers/Radius and <em>Enable Radius Server</em>.
        <ul>
          <li>The only thing you will do here is set the <em>L2TP Secret</em>.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="/images/vpnradiusserver.png" alt="" /></p>

<ul>
  <li>Next up on the configuration is to browse to <em>Settings</em> and <em>Networks</em>.
    <ul>
      <li>Here you will create a new network with the following details..
        <ul>
          <li>Purpose: Remote User VPN</li>
          <li>VPN Type: L2TP Server</li>
          <li>Pre Shared Key: This is the <em>secret</em> you configured for the Radius Server.</li>
          <li>Gateway/Subnet: IP Information for your VPN Clients</li>
          <li>Other: Fill in other fields as needed.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="/images/vpnnetworks.png" alt="" /></p>

<p>Once everything is complete you will now have an extra bubble with VPN statistics!</p>

<p><img src="/images/dashboardview.png" alt="" /></p>

<p>Nothing else is needed! Once the Unifi USG provisions it automatically adds in the needed firewall rules, you can now configure your normal L2TP client to connect.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?url=/ubiquiti/configuring-unifi-controller-and-usg-for-l2tp-vpn/&text=Configuring Unifi Controller and USG for L2TP VPN&via=davidstamen" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/ubiquiti/configuring-unifi-controller-and-usg-for-l2tp-vpn/" class="tumbler" title="Share on Facebook"><i class="fa fa-facebook-square fa-2x"></i></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/ubiquiti/configuring-unifi-controller-and-usg-for-l2tp-vpn/" class="tumbler" title="Share on Google Plus"><i class="fa fa-google-plus-square fa-2x"></i></a>
    </li>
    <li>
      <a href="http://www.linkedin.com/shareArticle?mini=true&url=/ubiquiti/configuring-unifi-controller-and-usg-for-l2tp-vpn/" class="tumbler" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin-square fa-2x"></i></a>
    </li>
    <li>
      <a href="http://www.reddit.com/submit?url=/ubiquiti/configuring-unifi-controller-and-usg-for-l2tp-vpn/&title=Configuring Unifi Controller and USG for L2TP VPN" class="tumbler" title="Share on Reddit"><i class="fa fa-fw fa-reddit-square fa-2x"></i></a>
    </li>
  </ul>
</div><!-- /.social-share -->

        <p class="byline"><strong>Configuring Unifi Controller and USG for L2TP VPN</strong> was published on <time datetime="2017-04-25T00:00:00-04:00">April 25, 2017</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/vrealize%20operations/using-powercli-to-add-vrealize-operations-license-key/" title="Using PowerCLI to Add vRealize Operations License Key">Using PowerCLI to Add vRealize Operations License Key</a></li>
    
      <li><a href="/powercli/using-powercli-to-set-vcenter-permissions-on-datacenter/" title="Using PowerCLI to Set vCenter Permissions on Datacenter">Using PowerCLI to Set vCenter Permissions on Datacenter</a></li>
    
      <li><a href="/vmware/vexpert-2017/" title="vExpert 2017">vExpert 2017</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    

<span>&copy; 2017 David Stamen. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a></span>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6907288179836979",
    enable_page_level_ads: true
  });
</script>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl =
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-67336507-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'davidstamen'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>





</body>
</html>

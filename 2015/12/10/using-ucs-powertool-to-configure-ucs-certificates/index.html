<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Using UCS PowerTool To Configure UCS Certificates &middot; davidstamen.com</title>
    <meta name="generator" content="Hugo 0.46" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="David Stamen">
    
      <meta name="description" content="a blog about virtualization and stuff">
    
    
    <link rel="canonical" href="http://davidstamen.com/2015/12/10/using-ucs-powertool-to-configure-ucs-certificates/"/>
    <link rel="icon" href="http://davidstamen.com/favicon.ico">
    <link rel="apple-touch-icon" href="http://davidstamen.com/apple-touch-icon.png"/>
    <link rel="stylesheet" href="http://davidstamen.com/css/style.css">
    <link rel="stylesheet" href="http://davidstamen.com/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://davidstamen.com/css/monokai.css">
    <link rel="stylesheet" href="http://davidstamen.com/fancybox/jquery.fancybox.css">
    
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta property="og:title" content="Using UCS PowerTool To Configure UCS Certificates" />
<meta property="og:description" content="Im finally getting to dive back in to working with UCS. My latest task with my project of configuring 9 UCS Domains, was swapping out certificates. The first few I did via the GUI, and I thought can this be scripted? Well the answer is yes! See below for information on executing the script.
Pre-Requsites  UCS Powertool  Link to Script  AddUCSCert.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://davidstamen.com/2015/12/10/using-ucs-powertool-to-configure-ucs-certificates/" />



<meta property="article:published_time" content="2015-12-10T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2015-12-10T00:00:00&#43;00:00"/>











    
    
<meta itemprop="name" content="Using UCS PowerTool To Configure UCS Certificates">
<meta itemprop="description" content="Im finally getting to dive back in to working with UCS. My latest task with my project of configuring 9 UCS Domains, was swapping out certificates. The first few I did via the GUI, and I thought can this be scripted? Well the answer is yes! See below for information on executing the script.
Pre-Requsites  UCS Powertool  Link to Script  AddUCSCert.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script.">


<meta itemprop="datePublished" content="2015-12-10T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2015-12-10T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="530">



<meta itemprop="keywords" content="Cisco," />

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using UCS PowerTool To Configure UCS Certificates"/>
<meta name="twitter:description" content="Im finally getting to dive back in to working with UCS. My latest task with my project of configuring 9 UCS Domains, was swapping out certificates. The first few I did via the GUI, and I thought can this be scripted? Well the answer is yes! See below for information on executing the script.
Pre-Requsites  UCS Powertool  Link to Script  AddUCSCert.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script."/>
<meta name="twitter:site" content="@davidstamen"/>

    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
<div class="container">


<div id="container">
	<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="http://davidstamen.com/" id="logo">
          
          <i class="logo" style="background-image: url('http://davidstamen.com/images/apple-touch-icon-57x57.png')"></i>
          
          <span class="site-title">davidstamen.com</span>
      </a>
      <nav id="main-nav">
          

          
          <a class="main-nav-link" href="/">Home</a>
          
          <a class="main-nav-link" href="/resources/">Resources</a>
          
          <a class="main-nav-link" href="/acclaim/">Acclaim</a>
          

          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="http://davidstamen.com/images/apple-touch-icon-57x57.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" class="search-form-input" placeholder="Search">
              <button type="submit" class="search-form-submit">
              </button>
              <input type="hidden" name="sitesearch" value="http://davidstamen.com/" />
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          

          
          <td><a class="main-nav-link" href="/">Home</a></td>
          
          <td><a class="main-nav-link" href="/resources/">Resources</a></td>
          
          <td><a class="main-nav-link" href="/acclaim/">Acclaim</a></td>
          

          
          <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" class="search-form-input" placeholder="Search">
          <input type="hidden" name="sitesearch" value="http://davidstamen.com/" />
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>

   	
   	<div class="outer">
   	
    	<aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      
      <img id="avatar" src="https://www.gravatar.com/avatar/2051e99107a154b541623e5dd75293d3?s=100&d=identicon"/>
      
      <h2 id="name">David Stamen</h2>
      <h3 id="title">Technical Marketing Engineer | VMware</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Kissimmee, FL</span>
      
          <a id="follow" href="https://twitter.com/davidstamen">
              Follow
          </a>
      
    </div>
    
    <div class="profile-block social-links">
      <table>
        <tr>
          
<td><a href="//github.com/dstamen" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>





































<td><a href="//linkedin.com/in/davidstamen" target="_blank" title="LinkedIn"><i class="fa fa-linkedin"></i></a></td>















<td><a href="//twitter.com/davidstamen" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="http://davidstamen.com/index.xml" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>
</aside>

    

    <section id="main">
    
    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        

        <header class="article-header">
    <a href="http://davidstamen.com/2015/12/10/using-ucs-powertool-to-configure-ucs-certificates/">
    <h1 class="article-title" itemprop="name">
        Using UCS PowerTool To Configure UCS Certificates
    </h1>
    </a>
    <div class="article-meta">

        
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2015-12-10 00:00:00 &#43;0000 UTC" itemprop="datePublished">12.10.2015</time>
        </div>
        
        

        
            
            
            <div class="article-category">
                <i class="fa fa-tags"></i>
                
                
                <a class="article-category-link" href="http://davidstamen.com/tags/cisco">Cisco</a>
                
                
            </div>
            
        
    </div>
</header>

        <div class="article-entry" itemprop="articleBody">
            

<p>Im finally getting to dive back in to working with UCS. My latest task with my project of configuring 9 UCS Domains, was swapping out certificates. The first few I did via the GUI, and I thought can this be scripted? Well the answer is yes! See below for information on executing the script.</p>

<h4 id="pre-requsites"><strong><em>Pre-Requsites</em></strong></h4>

<ul>
<li><a href="https://communities.cisco.com/docs/DOC-53838">UCS Powertool</a></li>
</ul>

<h4 id="link-to-script"><strong><em>Link to Script</em></strong></h4>

<ul>
<li><a href="https://github.com/dstamen/UCS-PowerTool/blob/master/AddUCSCert.ps1">AddUCSCert.ps1</a></li>
</ul>

<h4 id="preparing-to-execute-the-script"><strong><em>Preparing to Execute the Script</em></strong></h4>

<p>The script is pretty straight forward, just need to define a few variables seen below and then you execute the script. I will walk you through the process.</p>

<pre><code>#Define Variables
$UCS = &quot;FQDNofUCS&quot; #Used to Connect to UCSM via PowerTool
$TrustPoint = &quot;TP-Name&quot; #Name of TrustPoint, AKA Root CA
$KeyRing = &quot;KeyRingName&quot; #name of KeyRing. Stores Certificate Information
$Modulus = &quot;mod2048&quot; #2048 bit key this can be 1024,2048,4096, etc
$CertDNS = &quot;FQDNofUCS&quot; #FQDN for Cert Request
$CertLocality = &quot;City&quot; #City for Cert Request
$CertState = &quot;State&quot; #State for Cert Request
$CertCountry = &quot;US&quot; #Country for Cert Request
$CertOrgName = &quot;Org&quot; #OrgName for Cert Request
$CertEmail = &quot;me@lab.com&quot; #Email for Cert Request
$CertSubjName = &quot;FQDNofUCS&quot; #FQDN for Cert Request
$CertIP = &quot;FI-VIP-IP&quot; #FI-VIP IP for Cert Request
$CertIpA = &quot;FI-A-IP&quot; #FI-A IP for Cert Request
$CertIpB = &quot;FI-B-IP&quot; #FI-B IP for Cert Request
$TPChain = &quot;-----BEGIN CERTIFICATE-----
PASTE CERT CONTENT HERE FOR ROOTCA
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
PASTE CERT CONTENT HERE FOR SUB CA
-----END CERTIFICATE-----&quot; #Delete Second part if not using a Root/Sub Scenario.
</code></pre>

<p>To gather information for the variables above you should have most the information handy. To get the TPChain(The Root/Sub Certs) you can follow these steps.</p>

<ul>
<li>If using a Microsoft CA navigate to <a href="http://caroot/certsrv">http://caroot/certsrv</a>. From here you can download the CA Certificate. Make sure to download it in the Base 64 format.</li>
<li>If using a Microsoft Sub CA as well, navigate to <a href="http://casub/certsrv">http://casub/certsrv</a>. From here you can download the CA Certificate. Make sure to download it in the Base 64 format.</li>
</ul>

<p><img src="/images/downloadcacert.png" alt="" /></p>

<ul>
<li>If using a Non-Microsoft CA, contact your certificate provider for their root certificate and following the remaining steps.</li>
<li>Open Certificate using a text editor and you should have it in a standard format, paste that info in the variable field. If not using a Sub, Delete the second part.</li>
</ul>

<h4 id="executing-the-script"><strong><em>Executing the Script</em></strong></h4>

<ul>
<li>Navigate to the directory using PowerShell and run .\AddUCSCert.ps1</li>
<li>If you look inside UCSM you will see the script create the TrustPoint and KeyRing for the new certificate</li>
</ul>

<p><img src="/images/ucsmcert1.png" alt="" /></p>

<ul>
<li>If you navigate to the KeyRing you will see the completed certificate Request.</li>
</ul>

<p><img src="/images/ucsmcert2.png" alt="" /></p>

<ul>
<li>You will also see a popup, asking you for the completed certificate information. From here you will either submit it to your microsoft ca at htt://ca/certsrv and request an advanced web server certificate based on the CSR info in the keyring, or submit this to your 3rd party certificate provider.</li>
</ul>

<p><img src="/images/ucsmcert3.png" alt="" /></p>

<ul>
<li>Once you paste the completed certificate in the script will finish executing, and will input the certificate information and set UCSM to use the new certificate. (You will be disconnected and have to reconnect.)</li>
<li>You can verify the certificate information by logging back in and selecting the Certificate Details button on the keyring.</li>
</ul>

<p><img src="/images/ucsmcert4.png" alt="" /></p>

<h4 id="hope-this-helps-anyone-else-out-wanted-to-automate-certificate-replacement-on-cisco-ucs"><strong><em>Hope this helps anyone else out wanted to automate certificate replacement on Cisco UCS.</em></strong></h4>

        </div>
        <footer class="article-footer">
    <a data-url="http://davidstamen.com/2015/12/10/using-ucs-powertool-to-configure-ucs-certificates/" data-id="23cab89e5e38d2dda139263ef003abae" class="article-share-link">
        <i class="fa fa-share"></i>
        Share
    </a>
    
    <a href="http://davidstamen.com/2015/12/10/using-ucs-powertool-to-configure-ucs-certificates/#disqus_thread" class="article-comment-link">
        Comments
    </a>
    

    <script>
    (function ($) {
        
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="//twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="//www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="//plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                            '<a href="//www.linkedin.com/shareArticle?url=' + encodedUrl + '" class="fa fa-linkedin article-share-facebook target="_blank" title="LinkedIn+"></a>',
                            '<a href="//reddit.com/submit?url=' + encodedUrl + '" class="fa fa-reddit article-share-google target="_blank" title="Reddit"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
    </script>
</footer>

    </div>

    
<nav id="article-nav">
    
    <a href="http://davidstamen.com/2015/11/30/installing-host-vibs-using-powercli/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Older
      </strong>
      <div class="article-nav-title">Installing Host VIB&#39;s Using PowerCLI</div>
    </a>
    

    
    <a href="http://davidstamen.com/2015/12/11/using-ucs-powertool-to-configure-ucs-policy-backup-and-export/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Newer
      </strong>
      <div class="article-nav-title">Using UCS PowerTool To Configure UCS Policy Backup and Export</div>
    </a>
    
</nav>


</article>


<section id="comments">
    <div id="disqus_thread">
        
    </div>
</section>


    </section>

   	
    	<aside id="sidebar">
    

    
<div class="widget-wrap">
    <h3 class="widget-title">
        Recents
    </h3>
    <div class="widget">
        
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/10/11/why-and-how-to-upgrade-to-vsphere-6.7-u1/" class="title">Why and How To Upgrade to vSphere 6.7 U1</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/10/08/automating-the-upgrade-of-the-virtual-distributed-switch/" class="title">Automating the Upgrade of the Virtual Distributed Switch</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/10/07/automating-migration-of-vmfs-5-to-vmfs-6-datastores/" class="title">Automating Migration of VMFS-5 to VMFS-6 Datastores</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/10/06/automating-upgrade-of-vmware-tools-and-vm-compatibility/" class="title">Automating Upgrade of VMware Tools and VM Compatibility</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/10/05/upgrading-platform-services-controller-and-vcenter-server-via-the-cli-installer/" class="title">Upgrading Platform Services Controller and VCenter Server via the CLI Installer</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/08/15/l1-terminal-fault-l1tf-patching-considerations/" class="title">L1 Terminal Fault (L1TF) Patching Considerations</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/07/18/vmworld-2018-sessions-events/" class="title">VMworld 2018 - Sessions and Events</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/05/23/patching-your-vcenter-server-appliance-from-6.7-to-6.7a/" class="title">Patching your vCenter Server Appliance from 6.7 to 6.7a</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/04/17/upgrading-to-vmware-vsphere-6.7/" class="title">Upgrading to VMware vSphere 6.7</a></p><br>
                
            
            
            
                
                

                    <p class="item-title"><a href="http://davidstamen.com/2018/03/12/vexpert-2018/" class="title">vExpert 2018</a></p><br>
                
            
            
        
    </div>
</div>


    

    

    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tags
    </h3>
    <div class="widget tagcloud">
        
        
        <a href="http://davidstamen.com/tags/ansible" style="font-size: 12px;">ansible</a>
        
        
        <a href="http://davidstamen.com/tags/career" style="font-size: 12px;">career</a>
        
        
        <a href="http://davidstamen.com/tags/certification" style="font-size: 12px;">certification</a>
        
        
        <a href="http://davidstamen.com/tags/cisco" style="font-size: 12px;">cisco</a>
        
        
        <a href="http://davidstamen.com/tags/homelab" style="font-size: 12px;">homelab</a>
        
        
        <a href="http://davidstamen.com/tags/horizon-view" style="font-size: 12px;">horizon-view</a>
        
        
        <a href="http://davidstamen.com/tags/hugo" style="font-size: 12px;">hugo</a>
        
        
        <a href="http://davidstamen.com/tags/jekyll" style="font-size: 12px;">jekyll</a>
        
        
        <a href="http://davidstamen.com/tags/messaging" style="font-size: 12px;">messaging</a>
        
        
        <a href="http://davidstamen.com/tags/pernixdata" style="font-size: 12px;">pernixdata</a>
        
        
        <a href="http://davidstamen.com/tags/powercli" style="font-size: 12px;">powercli</a>
        
        
        <a href="http://davidstamen.com/tags/powerdns" style="font-size: 12px;">powerdns</a>
        
        
        <a href="http://davidstamen.com/tags/purestorage" style="font-size: 12px;">purestorage</a>
        
        
        <a href="http://davidstamen.com/tags/ravello" style="font-size: 12px;">ravello</a>
        
        
        <a href="http://davidstamen.com/tags/srm" style="font-size: 12px;">srm</a>
        
        
        <a href="http://davidstamen.com/tags/trend-micro" style="font-size: 12px;">trend-micro</a>
        
        
        <a href="http://davidstamen.com/tags/ubiquiti" style="font-size: 12px;">ubiquiti</a>
        
        
        <a href="http://davidstamen.com/tags/vagrant" style="font-size: 12px;">vagrant</a>
        
        
        <a href="http://davidstamen.com/tags/vcenter" style="font-size: 12px;">vcenter</a>
        
        
        <a href="http://davidstamen.com/tags/vcloud-air" style="font-size: 12px;">vcloud-air</a>
        
        
        <a href="http://davidstamen.com/tags/vdp" style="font-size: 12px;">vdp</a>
        
        
        <a href="http://davidstamen.com/tags/veeam" style="font-size: 12px;">veeam</a>
        
        
        <a href="http://davidstamen.com/tags/vexpert" style="font-size: 12px;">vexpert</a>
        
        
        <a href="http://davidstamen.com/tags/vmware" style="font-size: 12px;">vmware</a>
        
        
        <a href="http://davidstamen.com/tags/vmworld" style="font-size: 12px;">vmworld</a>
        
        
        <a href="http://davidstamen.com/tags/vra" style="font-size: 12px;">vra</a>
        
        
        <a href="http://davidstamen.com/tags/vrops" style="font-size: 12px;">vrops</a>
        
        
        <a href="http://davidstamen.com/tags/vsphereupgrade" style="font-size: 12px;">vsphereupgrade</a>
        
        
        <a href="http://davidstamen.com/tags/windows" style="font-size: 12px;">windows</a>
        
    </div>
</div>




    
</aside>

    
	</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018
      davidstamen.com
    </div>
  </div>
</footer>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-67336507-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

<script src="http://davidstamen.com/fancybox/jquery.fancybox.pack.js"></script>
<script src="http://davidstamen.com/js/script.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>


<script>hljs.initHighlightingOnLoad();</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




</body>
</html>
<!doctype html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class=no-js><!--<![endif]--><head><meta charset=utf-8><title>PowerCLI &#183; davidstamen.com</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta property="og:type" content="website"><link rel=canonical href=https://davidstamen.com/tags/powercli/><link rel=apple-touch-icon-precomposed sizes=144x144 href=/touch-icon-144-precomposed.png><link rel=icon href=/favicon/favicon.ico><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6907288179836979",enable_page_level_ads:true});</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/js/clr-3.0/clr-icons.min.js></script><script src=/js/clr-3.0/custom-elements.min.js></script><link href=/css/clr-3.0/clr-ui.css rel=stylesheet><link href=/css/clr-3.0/clr-icons.min.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><link rel=stylesheet href=/css/all.css></head><body data-ng-app=myapp data-ng-controller=MyController data-ng-mouseleave=MouseLeave($event)><div class=main-container><header class=header-2><div class=branding><a class=navbar-brand-img href=/><img alt src>
<span class=title>davidstamen.com</span></a></div><div class=header-nav [clr-nav-level]=1><a class="nav-link nav-text" href=https://davidstamen.com/ title=Home>Home</a>
<a class="nav-link nav-text" href=https://davidstamen.com/categories/pure-storage/ title="Pure Storage">Pure Storage</a>
<a class="nav-link nav-text" href=https://davidstamen.com/categories/vmware/ title=VMware>VMware</a>
<a class="nav-link nav-text" href=https://davidstamen.com/tags/ title=Tags>Tags</a>
<a class="nav-link nav-text" href=https://davidstamen.com/series/ title=Series>Series</a>
<a class="nav-link nav-text" href=https://www.youracclaim.com/users/davidstamen title=Acclaim>Acclaim</a>
<a class="nav-link nav-text" href=https://davidstamen.com/about title=About>About</a></div><div class=header-actions><form class=search id=search method=get action=//google.com/search><label for=search_input><input id=search_input type=text name=q placeholder=Search>
<input type=hidden name=as_sitesearch value=davidstamen.com></label></form></div></header><div class=content-container><div class=content-area><h1>PowerCLI</h1><div class=clr-row><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2016/01/29/using-powercli-to-install-software-in-a-guest-vm/>Using PowerCLI to Install Software in a Guest VM</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
January 29, 2016 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I have been constantly trying to figure out the best way to deploy updated agents to some of our virtual desktops. It isnt a large environment so I have no need for SCCM or other deployment tools, but its big enough having to RDP to each VM was a pain. I finally decided to bang out a script, and surprised how well it works.
Pre-Requsites VMware PowerCLI Link to Script InstallVMSoftware.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2016/01/26/using-powercli-to-replicate-templates-to-multiple-clusters/>Using PowerCLI to Replicate Templates to Multiple Clusters</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
January 26, 2016 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
We have multiple clusters within our vCenters that are defined as a rack. Each rack has its own storage, so storage is not shared between clusters. I needed to develop a way to easily replicate templates between clusters, so a local copy existed on each cluster to take advantage of VAAI.
I really wanted to utilize the vSphere Content Libary for these, but there is currently no publicly available documentation on how to deploy a VM from a Content Library via a Script.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2016/01/13/unable-to-boot-efi-vm-on-esxi-fc-storage/>Unable to Boot EFI VM on ESXi FC Storage</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
January 13, 2016 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
For the past week, I have been troubleshooting the strangest issue. I have been attempting to move some Windows 8.1 VM’s from our legacy datacenter(iSCSI) to our new datacenter(FC).
Whenever I would move the VM to our new DC, it would fail to boot properly. It would boot straight to Windows Recovery. If I moved the same VM to any other type of storage(NFS, iSCSI, Local) the VM would boot perfectly fine.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/storage>Storage</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2015/11/30/installing-host-vibs-using-powercli/>Installing Host VIB's Using PowerCLI</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
November 30, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
Normally when i need to install and update a host VIB I use Update Manager. However there is currently a bug with Cisco’s latest enic/fnic drivers that wont let you install them via UM.
I had to run these updates on over 50 hosts and I really didn’t want to have to ssh and install it manually. Lucky I remember Brian Graf&amp;rsquo;s Host Client Install Fling and borrowed some of the code to come up with the below script.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/esxi>ESXi</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2015/11/18/disconnected-vnics/>Disconnected vNIC's?</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
November 18, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
Ever wonder why a VM isn’t on the network?
I was working on deploying some test VM’s and for some reason all the VM’s that were cloned decided to start with the network disconnected, and the connect on power on was also not selected.
I decided to throw together this quick one-liner that will make sure every VM is set to start connected on power on and is currently connected.</div></div><div class=card-footer>Tagged <a href=/tags/networking>Networking</a> and <a href=/tags/powercli>PowerCLI</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2015/10/08/using-powercli-to-build-out-vcenter/>Using PowerCLI to Build Out vCenter</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
October 8, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I wanted to share this handy script i created when you have a need to build out a new vCenter.
This script can be extremely handy as it will take care of creating the datacenter, cluster, adding hosts, creating datastores and then applying the appropriate host profile. It is all done via CSV files so it is extremely customizable.
Files to modify to customize your configuration createdatacenter.csv - Contains the name of the datacenter to create.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/vcenter-server>vCenter Server</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2015/09/15/using-powercli-to-extend-vmdk-and-windows-os-disk/>Using PowerCLI to Extend VMDK and Windows OS Disk</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
September 15, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I wanted to share this handy script i created when you have a need to extend a disk.
This script can be extremely handy as it will take care of extending the VMDK and then going to the OS and then performing the expansion there as well. This has been helpful when needing to extend a large batch of servers (60+).
Syntax: .\ExtendVMDKandGuest VMNAME
You will then be prompted to enter in the Hard Disk #, the size you want to be extended, and then which drive letter that volume belongs to.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/storage>Storage</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2015/09/14/using-powercli-to-detach-luns/>Using PowerCLI to Detach Luns</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
September 14, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I thought I would share this script, its been circulating a bit but I feel it is a nice one to have in your toolkit.
Have you ever had to remove a LUN from a cluster and thought “Do I really need to detach all the LUN’s, before un-mapping from my SAN?”
Unmount Datastore Detach LUN Un-map from SAN Rescan Cluster Well here is a handy script with output.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/storage>Storage</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2015/04/02/powercli-extend-vmdk-and-guest-os/>PowerCLI - Extend VMDK and Guest OS</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
April 2, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
So as always things change across multiple Window’s operating systems and VMware revisions. I had a need to extend the drives on about 50 VMs today and really didn’t want to do all that clicking. I remember awhile back it was easy to do this with a Basic Set-Harddisk and use the -ResizeGuestPartition but alas that has been removed from the current functionality. So I took my search to google and found a couple scripts that worked ok, but nothing that was a seamless experience.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/storage>Storage</a></div></div></div><div class="clr-col-12 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><div class=card><div class=card-header><a href=https://davidstamen.com/2015/01/29/powercli-troubleshooting-multiple-default-servers/>PowerCLI - Troubleshooting Multiple Default Servers</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
January 29, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I use a customized version of &lt;a href="http://www.virtu-al.net/vcheck-pluginsheaders/vcheck/">http://www.virtu-al.net/vcheck-pluginsheaders/vcheck/&lt;/a> by Alan Renouf to connect to multiple servers. However a coworker of mine was trying to run it, and the script would only return data from the 2nd vCenter we were connecting to.
Doing some troubleshooting we noticed their DefaultVIServerMode was set to single. This means that only a single servers connection will occur at once. Changing this setting is very easy, there are 3 scopes, but only one really needs to be set.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a></div></div></div></div><nav><ul class=pagination><li class="pagination__item pagination__item--first"><a class="btn btn-sm btn btn-outline" href=/tags/powercli/>1</a></li><li class="pagination__item pagination__item--previous"><a href=/tags/powercli/ class="btn btn-sm btn btn-outline">...</a></li><li class=pagination__item><a href=/tags/powercli/ class="btn btn-sm btn btn-outline">1</a></li><li class="pagination__item pagination__item--current"><a href=/tags/powercli/page/2/ class="btn btn-sm btn btn-primary">2</a></li><li class=pagination__item><a href=/tags/powercli/page/3/ class="btn btn-sm btn btn-outline">3</a></li><li class="pagination__item pagination__item--next"><a href=/tags/powercli/page/3/ class="btn btn-sm btn-outline">...</a></li><li class="pagination__item pagination__item--last"><a class="btn btn-sm btn btn-outline" href=/tags/powercli/page/3/>3</a></li></ul></nav></div><nav class="sidenav clr-col-2 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><section class=sidenav-content><div class=card><div class=card-block><div class=card-text id=site-intro><img src=/images/me2-300.png><p>a blog about virtualization, storage and stuff<ul class=nav-list-inline><a href=//github.com/dstamen target=_blank rel=noopener title=GitHub class="fab fa-github"></a><a href=//linkedin.com/in/davidstamen target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a><a href=//twitter.com/davidstamen target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a><a href=mailto:dstamen@gmail.com target=_blank title=Email class="fas fa-envelope"></a><a href=/tags/powercli/index.xml type=application/rss+xml target=_blank title=RSS class="fas fa-rss"></a></ul></div></div></div><div class=card><div class=card-header><b>Latest Posts</b></div><div class=card-block><div class=card-text><ul class=list style=list-style-type:square;list-style-position:inherit><li><a class=nav-list href=https://davidstamen.com/2020/06/30/using-terraform-to-deploy-the-pure1-vm-analytics-collector/>Using Terraform to Deploy the Pure1 VM Analytics Collector</a></li><li><a class=nav-list href=https://davidstamen.com/2020/06/29/using-terraform-to-deploy-the-vmware-event-broker-appliance/>Using Terraform to Deploy the VMware Event Broker Appliance</a></li><li><a class=nav-list href=https://davidstamen.com/2020/06/29/using-terraform-to-deploy-the-vmware-nested-esxi-appliance/>Using Terraform to Deploy the VMware Nested ESXi Appliance</a></li><li><a class=nav-list href=https://davidstamen.com/2020/06/26/using-terraform-to-deploy-the-site-recovery-manager-8.3-appliance/>Using Terraform to Deploy the Site Recovery Manager 8.3 Appliance</a></li><li><a class=nav-list href=https://davidstamen.com/using-veba-to-expand-pure-datastore/>Using the VMware Event Broker Appliance to Automatically Expand a Pure Storage FlashArray Datastore</a></li><li><a class=nav-list href=https://davidstamen.com/2020/06/22/updating-the-vcenter-server-appliance-vcsa-with-powercli-revisited/>Updating the vCenter Server Appliance (VCSA) with PowerCLI - Revisited</a></li><li><a class=nav-list href=https://davidstamen.com/2020/06/05/configuring-vrealize-orchestrator-to-use-pure1-integration/>Configuring vRealize Orchestrator to use Pure1 Integration</a></li><li><a class=nav-list href=https://davidstamen.com/2020/06/02/unable-to-provision-a-vvol-hard-disk-on-a-vm-located-on-vmfs-datastore/>Unable to Provision a vVol Hard Disk on a VM Located on VMFS Datastore</a></li><li><a class=nav-list href=https://davidstamen.com/updating-vk8s-supervisor-cluster/>Updating a vSphere with Kubernetes Supervisor Cluster</a></li><li><a class=nav-list href=https://davidstamen.com/2020/05/26/whats-new-in-the-4.3.1-pure-storage-vsphere-client-plugin/>What's New in the 4.3.1 Pure Storage vSphere Client Plugin</a></li></ul></div></div></div></section></nav></div></div></body></html>
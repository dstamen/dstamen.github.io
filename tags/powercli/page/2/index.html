<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PowerCLI  &middot; davidstamen.com</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


  <meta name="description" content="" />

  <meta name="keywords" content="">




<meta property="og:type" content="website" />


  <link rel="canonical" href="/tags/powercli/" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="icon" href="/favicon/favicon.ico">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6907288179836979",
    enable_page_level_ads: true
  });
</script>

  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    
    <script src="/js/clr-2.0/clr-icons.min.js"></script>
    <script src="/js/clr-2.0/custom-elements.min.js"></script>

    
    <link rel="stylesheet" href="https://unpkg.com/@clr/ui/clr-ui.css" />
    
    <link rel="stylesheet" href="https://unpkg.com/@clr/icons/clr-icons.min.css" />

    <link href="/css/custom.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/all.css">
</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
  <div class="main-container">
    
<header class="header-2">
  <div class="branding">
    

    
    <a class="navbar-brand-img" href="/">
      <img alt="" src="">
      <span class="title">davidstamen.com</span>
      
    </a>
  </div>
  <div class="header-nav" [clr-nav-level]="1">
    
    
        <a class="nav-link  nav-text" href="/" title="Home">
          
          Home
        </a>
    
        <a class="nav-link  nav-text" href="/tags/" title="Tags">
          
          Tags
        </a>
    
        <a class="nav-link  nav-text" href="/categories/" title="Categories">
          
          Categories
        </a>
    
        <a class="nav-link  nav-text" href="/series/" title="Series">
          
          Series
        </a>
    
        <a class="nav-link  nav-text" href="/acclaim" title="Acclaim">
          
          Acclaim
        </a>
    
        <a class="nav-link  nav-text" href="/about" title="About">
          
          About
        </a>
    
  </div>
  <div class="header-actions">
  <form class="search" id="search" method="get" action="//google.com/search">
    <label for="search_input">
        <input id="search_input" type="text" name="q" placeholder="Search">
        <input type="hidden" name="as_sitesearch" value="davidstamen.com">
    </label>
</form>
</div>
</header>
<nav class="subnav" [clr-nav-level]="2">
  <ul class="nav">
    
    
    <li class="nav-item">
        <a class="nav-link " href="/vcsa-json-creator" title="VCSA JSON Creator 9000">
          
          VCSA JSON Creator 9000
        </a>
    </li>
    
  </ul>
</nav>


<div class="content-container">
  <div class="content-area">
    <h1>PowerCLI
</h1>

    <div class="clr-row">
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2015/09/15/using-powercli-to-extend-vmdk-and-windows-os-disk/">Using PowerCLI to Extend VMDK and Windows OS Disk</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
September 15, 2015 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    I wanted to share this handy script i created when you have a need to extend a disk.
This script can be extremely handy as it will take care of extending the VMDK and then going to the OS and then performing the expansion there as well. This has been helpful when needing to extend a large batch of servers (60&#43;).
Syntax: .\ExtendVMDKandGuest VMNAME
You will then be prompted to enter in the Hard Disk #, the size you want to be extended, and then which drive letter that volume belongs to.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/storage">Storage</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2015/09/14/using-powercli-to-detach-luns/">Using PowerCLI to Detach Luns</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
September 14, 2015 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    I thought I would share this script, its been circulating a bit but I feel it is a nice one to have in your toolkit.
Have you ever had to remove a LUN from a cluster and thought “Do I really need to detach all the LUN’s, before un-mapping from my SAN?”
Unmount Datastore Detach LUN Un-map from SAN Rescan Cluster  Well here is a handy script with output.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/storage">Storage</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2015/04/02/powercli-extend-vmdk-and-guest-os/">PowerCLI - Extend VMDK and Guest OS</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
April 2, 2015 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    So as always things change across multiple Window’s operating systems and VMware revisions. I had a need to extend the drives on about 50 VMs today and really didn’t want to do all that clicking. I remember awhile back it was easy to do this with a Basic Set-Harddisk and use the -ResizeGuestPartition but alas that has been removed from the current functionality. So I took my search to google and found a couple scripts that worked ok, but nothing that was a seamless experience.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/storage">Storage</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2015/01/29/powercli-troubleshooting-multiple-default-servers/">PowerCLI - Troubleshooting Multiple Default Servers</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 29, 2015 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    I use a customized version of &lt;a href=&#34;http://www.virtu-al.net/vcheck-pluginsheaders/vcheck/&#34;&gt;http://www.virtu-al.net/vcheck-pluginsheaders/vcheck/&lt;/a&gt; by Alan Renouf to connect to multiple servers. However a coworker of mine was trying to run it, and the script would only return data from the 2nd vCenter we were connecting to.
Doing some troubleshooting we noticed their DefaultVIServerMode was set to single. This means that only a single servers connection will occur at once. Changing this setting is very easy, there are 3 scopes, but only one really needs to be set.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2015/01/14/powercli-enable-cpu-and-memory-hotadd/">PowerCLI - Enable CPU and Memory HotAdd</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 14, 2015 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    I had a need to enable CPU and Memory hotadd to many virtual machines prior to a template being updated, doing some research there is no easy way, however there are some functions out there to do it. You can copy and paste each function into a powershell window and then run the associated command.
Enable-MemHotAdd $ServerName Disable-MemHotAdd $ServerName Enable-vCPUHotAdd $ServerName Disable-vCPUHotAdd $ServerName Enable Memory HotAdd Function Enable-MemHotAdd($vm){ $vmview = Get-vm $vm | Get-View $vmConfigSpec = New-Object VMware.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2014/07/08/sysprep-runs-repeatedly-on-virtual-machines-deployed-to-esxi-5-1-build-1743533/">Sysprep runs repeatedly on virtual machines deployed to ESXi 5.1 build 1743533</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
July 8, 2014 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    We had a strange issue that any time a VM was snapshotted it then forced a reboot and sysprep. Reviewing the customization logs(C:\windows\temp\vmware-imc\guestcust.log) I noticed the following error..Unable to set customization status in vmx.
Upon further research it seems this is a known issue and is resolved in ESXi 5.1 Express Patch 5 KB2077640 as referenced in this article KB2078352.
However the hotfix only fixes future occurences, you still need to fix all the VMs affected.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a>, <a class="" href="/tags/sysprep">Sysprep</a> and <a class="" href="/tags/vsphere-5.1">vSphere 5.1</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2014/06/10/configuring-esxi-5-5-dump-collector/">Configuring ESXi 5.5 Dump Collector</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
June 10, 2014 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    Thank you to everyone who listened to me on the EMEA vBrownbag. Here are copies of documentation and scripts on how to configure ESXi to use the remote dump collector.
Check the ESXi Dump Collector Configuration Example: Foreach ($vmhost in (get-vmhost)){ $esxcli = Get-EsxCli -vmhost $vmhost $esxcli.system.coredump.network.get()} Setting the ESXi Dump Collector Example: Foreach ($vmhost in (get-vmhost)) { $esxcli = Get-EsxCli -vmhost $vmhost $esxcli.system.coredump.network.set($null, “vmk0″, “IPtoDumpCollector″, “6500″) $esxcli.system.coredump.network.set($true)} Test Host by Causing PSOD Run the following command via SSH or Direct Shell.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/dump-collector">Dump Collector</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2014/06/10/configuring-esxi-5-5-syslog-collector/">Configuring ESXi 5.5 Syslog Collector</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
June 10, 2014 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    Thank you to everyone who listened to me on the EMEA vBrownbag. Here are copies of documentation and scripts on how to configure ESXi to use the Syslog collector.
Check the ESXi Syslog Collector Configuration Example: Foreach ($vmhost in (get-vmhost)){ $esxcli = Get-EsxCli -vmhost $vmhost $esxcli.system.syslog.config.get()} Setting the ESXi Syslog Collector Example: Foreach ($vmhost in (get-vmhost)){ $esxcli = Get-EsxCli -vmhost $vmhost $esxcli.system.syslog.config.set($null, $null, $null, $null,&#34;udp://IPtoSyslogServer:514″) $esxcli.system.syslog.reload()} Post-Installation Changes If you wish to change the default port or maxsize of the syslog rotation, these can be changed by modifying the vmconfig-syslog.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/syslog">Syslog</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2014/05/22/create-vmfs-datastore-using-powercli/">Create VMFS Datastore Using PowerCLI</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
May 22, 2014 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    For upcoming testing there was a need to create 140 datastores on a cluster for testing. Who wants to do that much clicking and typing? Not me! You can use the below PowerCLI commands to get the SCSI ID’s, Create the Datastore and then Rescan all hosts in the cluster.
How do i get the CanonicalName for allocated disks? Get-SCSILun -VMhost 192.168.1.103 -LunType Disk | Select CanonicalName,Capacity How do I create a VMFS datastore for the CanonicalName I identified above?
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/storage">Storage</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2014/05/06/get-naa-id-for-virtual-machine-rdms-in-vmware/">Get NAA.ID for Virtual Machine RDM&#39;s in VMware</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
May 6, 2014 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    This is a great script to keep handy. If you have multiple RDM’s on a VM and need to get the NAA_ID for them the below PowerCLI command will get you that information.
Get-VM VMNAME| Get-HardDisk -DiskType &#34;RawPhysical&#34;,&#34;RawVirtual&#34; | Select Parent,Name,DiskType,ScsiCanonicalName,DeviceName,CapacityGB | fl If you then need to match the SCSI virtual disk to the Guest OS this is a great article on how to do so.
KB2051606
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/storage">Storage</a>
        </div>
    </div>
</div>
    
    </div>
    
<nav>
    
















  <ul class="pagination">
    
    
    
    <li class="pagination__item pagination__item--first">
      <a class="btn btn-sm btn btn-outline" href="/tags/powercli/">
        1
      </a>
    </li>
    

    
    
    <li class="pagination__item pagination__item--previous">
      <a href="/tags/powercli/" class="btn btn-sm btn btn-outline">
        ...
      </a>
    </li>
    

    
    
    
      

      
      
      

        

      

      
      
        <li class="pagination__item">
          <a href="/tags/powercli/" class="btn btn-sm  btn btn-outline">
            1
          </a>
        </li>
      

    
    
      

      
      
      

        

      

      
      
        <li class="pagination__item pagination__item--current">
          <a href="/tags/powercli/page/2/" class="btn btn-sm  btn btn-primary ">
            2
          </a>
        </li>
      

    

    
    

    
    

  </ul>

</nav>


  </div>
  
    <nav class="sidenav clr-col-2 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6">
  <section class="sidenav-content">
    
    
    
    <div class="card">
    <div class="card-block">
    <div class="card-text" id="site-intro">
      <img src="/images/me2-300.png">
        <p>a blog about virtualization and stuff
        
        <ul class="nav-list-inline">
          <a href="//github.com/dstamen" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a>











<a href="//linkedin.com/in/davidstamen" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a>















<a href="//twitter.com/davidstamen" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a>








<a href="mailto:dstamen@gmail.com" target="_blank" title="Email" class="fas fa-envelope"></a>

          
    <a href="/tags/powercli/index.xml" type="application/rss+xml" target="_blank" title="RSS" class="fas fa-rss"></a>


        </ul>
        
    </div>
    </div>
    </div>
    <div class="card">
    <div class="card-header">
      <b>Latest Posts</b>
    </div>
  <div class="card-block">
    <div class="card-text">
      <ul class="list" style="list-style-type:square;list-style-position:inherit">
        
        <li><a class="nav-list" href="/2020/01/13/my-certified-kubernetes-administrator-cka-exam-experience/">My Certified Kubernetes Administrator (CKA) Exam Experience</a></li>
        
        <li><a class="nav-list" href="/2019/09/24/vmworld-eu-2019-vsphere-lifecycle-sessions/">VMworld EU 2019 - vSphere Lifecycle Sessions</a></li>
        
        <li><a class="nav-list" href="/2019/08/12/windows-server-2008-is-going-eol-what-about-my-vcenter-server/">Windows Server 2008 is Going EOL - What about my vCenter Server?</a></li>
        
        <li><a class="nav-list" href="/2019/06/18/vmworld-2019-sessions-and-events/">VMworld 2019 - Sessions and Events</a></li>
        
        <li><a class="nav-list" href="/2019/06/07/vcenter-server-converge-tool-what-about-my-certificates/">vCenter Server Converge Tool - What About My Certificates</a></li>
        
      </ul>
    </div>
  </div>
</div>
<div class="card">
  <div class="card-header">
    <b>Advertisements</b>
  </div>
<div class="card-block">
  <div class="card-text" align="center">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<ins class="adsbygoogle"
     style="display:inline-block;width:180px;height:150px"
     data-ad-client="ca-pub-6907288179836979"
     data-ad-slot="6070718289"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
  </div>
</div>
</div>

</section>
</nav>
  
</div>
      
    </div>
  </body>
</html>


<!doctype html><!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]--><!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if IE 8]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class=no-js><!--<![endif]--><head><meta charset=utf-8><title>PowerCLI &#183; davidstamen.com</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta property="og:type" content="website"><link rel=canonical href=https://davidstamen.com/tags/powercli/><link rel=apple-touch-icon-precomposed sizes=144x144 href=/touch-icon-144-precomposed.png><link rel=icon href=/favicon/favicon.ico><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6907288179836979",enable_page_level_ads:true});</script><!--[if lt IE 9]><script src=https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js></script><script src=https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js></script><![endif]--><script src=/js/clr-3.0/clr-icons.min.js></script><script src=/js/clr-3.0/custom-elements.min.js></script><link href=/css/clr-3.0/clr-ui.css rel=stylesheet><link href=/css/clr-3.0/clr-icons.min.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><link rel=stylesheet href=/css/all.css></head><body data-ng-app=myapp data-ng-controller=MyController data-ng-mouseleave=MouseLeave($event)><div class=main-container><header class=header-2><div class=branding><a class=navbar-brand-img href=/><img alt src>
<span class=title>davidstamen.com</span></a></div><div class=header-nav [clr-nav-level]=1><a class="nav-link nav-text" href=https://davidstamen.com/ title=Home>Home</a>
<a class="nav-link nav-text" href=https://davidstamen.com/categories/pure-storage/ title="Pure Storage">Pure Storage</a>
<a class="nav-link nav-text" href=https://davidstamen.com/categories/vmware/ title=VMware>VMware</a>
<a class="nav-link nav-text" href=https://davidstamen.com/tags/ title=Tags>Tags</a>
<a class="nav-link nav-text" href=https://davidstamen.com/series/ title=Series>Series</a>
<a class="nav-link nav-text" href=https://www.youracclaim.com/users/davidstamen title=Acclaim>Acclaim</a>
<a class="nav-link nav-text" href=https://davidstamen.com/about title=About>About</a></div><div class=header-actions><form class=search id=search method=get action=//google.com/search><label for=search_input><input id=search_input type=text name=q placeholder=Search>
<input type=hidden name=as_sitesearch value=davidstamen.com></label></form></div></header><div class=content-container><div class=content-area><h1>PowerCLI</h1><div class=clr-row><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2015/11/30/installing-host-vibs-using-powercli/>Installing Host VIB's Using PowerCLI</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
November 30, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
Normally when i need to install and update a host VIB I use Update Manager. However there is currently a bug with Cisco’s latest enic/fnic drivers that wont let you install them via UM.
I had to run these updates on over 50 hosts and I really didn’t want to have to ssh and install it manually. Lucky I remember Brian Graf&amp;rsquo;s Host Client Install Fling and borrowed some of the code to come up with the below script.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/esxi>ESXi</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2015/11/18/disconnected-vnics/>Disconnected vNIC's?</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
November 18, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
Ever wonder why a VM isn’t on the network?
I was working on deploying some test VM’s and for some reason all the VM’s that were cloned decided to start with the network disconnected, and the connect on power on was also not selected.
I decided to throw together this quick one-liner that will make sure every VM is set to start connected on power on and is currently connected.</div></div><div class=card-footer>Tagged <a href=/tags/networking>Networking</a> and <a href=/tags/powercli>PowerCLI</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2015/10/08/using-powercli-to-build-out-vcenter/>Using PowerCLI to Build Out vCenter</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
October 8, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I wanted to share this handy script i created when you have a need to build out a new vCenter.
This script can be extremely handy as it will take care of creating the datacenter, cluster, adding hosts, creating datastores and then applying the appropriate host profile. It is all done via CSV files so it is extremely customizable.
Files to modify to customize your configuration createdatacenter.csv - Contains the name of the datacenter to create.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/vcenter-server>vCenter Server</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2015/09/15/using-powercli-to-extend-vmdk-and-windows-os-disk/>Using PowerCLI to Extend VMDK and Windows OS Disk</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
September 15, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I wanted to share this handy script i created when you have a need to extend a disk.
This script can be extremely handy as it will take care of extending the VMDK and then going to the OS and then performing the expansion there as well. This has been helpful when needing to extend a large batch of servers (60+).
Syntax: .\ExtendVMDKandGuest VMNAME
You will then be prompted to enter in the Hard Disk #, the size you want to be extended, and then which drive letter that volume belongs to.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/storage>Storage</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2015/09/14/using-powercli-to-detach-luns/>Using PowerCLI to Detach Luns</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
September 14, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I thought I would share this script, its been circulating a bit but I feel it is a nice one to have in your toolkit.
Have you ever had to remove a LUN from a cluster and thought “Do I really need to detach all the LUN’s, before un-mapping from my SAN?”
Unmount Datastore Detach LUN Un-map from SAN Rescan Cluster Well here is a handy script with output.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/storage>Storage</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2015/04/02/powercli-extend-vmdk-and-guest-os/>PowerCLI - Extend VMDK and Guest OS</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
April 2, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
So as always things change across multiple Window’s operating systems and VMware revisions. I had a need to extend the drives on about 50 VMs today and really didn’t want to do all that clicking. I remember awhile back it was easy to do this with a Basic Set-Harddisk and use the -ResizeGuestPartition but alas that has been removed from the current functionality. So I took my search to google and found a couple scripts that worked ok, but nothing that was a seamless experience.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/storage>Storage</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2015/01/29/powercli-troubleshooting-multiple-default-servers/>PowerCLI - Troubleshooting Multiple Default Servers</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
January 29, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I use a customized version of &lt;a href="http://www.virtu-al.net/vcheck-pluginsheaders/vcheck/">http://www.virtu-al.net/vcheck-pluginsheaders/vcheck/&lt;/a> by Alan Renouf to connect to multiple servers. However a coworker of mine was trying to run it, and the script would only return data from the 2nd vCenter we were connecting to.
Doing some troubleshooting we noticed their DefaultVIServerMode was set to single. This means that only a single servers connection will occur at once. Changing this setting is very easy, there are 3 scopes, but only one really needs to be set.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2015/01/14/powercli-enable-cpu-and-memory-hotadd/>PowerCLI - Enable CPU and Memory HotAdd</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
January 14, 2015 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
I had a need to enable CPU and Memory hotadd to many virtual machines prior to a template being updated, doing some research there is no easy way, however there are some functions out there to do it. You can copy and paste each function into a powershell window and then run the associated command.
Enable-MemHotAdd $ServerName Disable-MemHotAdd $ServerName Enable-vCPUHotAdd $ServerName Disable-vCPUHotAdd $ServerName Enable Memory HotAdd Function Enable-MemHotAdd($vm){ $vmview = Get-vm $vm | Get-View $vmConfigSpec = New-Object VMware.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2014/07/08/sysprep-runs-repeatedly-on-virtual-machines-deployed-to-esxi-5-1-build-1743533/>Sysprep runs repeatedly on virtual machines deployed to ESXi 5.1 build 1743533</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
July 8, 2014 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
We had a strange issue that any time a VM was snapshotted it then forced a reboot and sysprep. Reviewing the customization logs(C:\windows\temp\vmware-imc\guestcust.log) I noticed the following error..Unable to set customization status in vmx.
Upon further research it seems this is a known issue and is resolved in ESXi 5.1 Express Patch 5 KB2077640 as referenced in this article KB2078352.
However the hotfix only fixes future occurences, you still need to fix all the VMs affected.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a>, <a href=/tags/sysprep>Sysprep</a> and <a href=/tags/vsphere-5.1>vSphere 5.1</a></div></div></div><div class=clr-col-12><div class=card><div class=card-header><a href=https://davidstamen.com/2014/06/10/configuring-esxi-5-5-dump-collector/>Configuring ESXi 5.5 Dump Collector</a></div><div class=card-block><div class=card-media-block><div class="card-media-desciption clr-card-authors"><span class="card-media-title clr-card-authors"><div class=clr-card-authors>Published on
June 10, 2014 under <a href=/categories/vmware>VMware</a></div></span></div></div></div><div class=card-block><div class=card-text style=max-height:100px;min-height:100px;overflow:hidden><img src=/featured/powercli.png class=clr-card-featured-image>
Thank you to everyone who listened to me on the EMEA vBrownbag. Here are copies of documentation and scripts on how to configure ESXi to use the remote dump collector.
Check the ESXi Dump Collector Configuration Example: Foreach ($vmhost in (get-vmhost)){ $esxcli = Get-EsxCli -vmhost $vmhost $esxcli.system.coredump.network.get()} Setting the ESXi Dump Collector Example: Foreach ($vmhost in (get-vmhost)) { $esxcli = Get-EsxCli -vmhost $vmhost $esxcli.system.coredump.network.set($null, “vmk0″, “IPtoDumpCollector″, “6500″) $esxcli.system.coredump.network.set($true)} Test Host by Causing PSOD Run the following command via SSH or Direct Shell.</div></div><div class=card-footer>Tagged <a href=/tags/powercli>PowerCLI</a> and <a href=/tags/dump-collector>Dump Collector</a></div></div></div></div><nav><ul class=pagination><li class="pagination__item pagination__item--first"><a class="btn btn-sm btn btn-outline" href=/tags/powercli/>1</a></li><li class="pagination__item pagination__item--previous"><a href=/tags/powercli/ class="btn btn-sm btn btn-outline">...</a></li><li class=pagination__item><a href=/tags/powercli/ class="btn btn-sm btn btn-outline">1</a></li><li class="pagination__item pagination__item--current"><a href=/tags/powercli/page/2/ class="btn btn-sm btn btn-primary">2</a></li><li class=pagination__item><a href=/tags/powercli/page/3/ class="btn btn-sm btn btn-outline">3</a></li><li class="pagination__item pagination__item--next"><a href=/tags/powercli/page/3/ class="btn btn-sm btn-outline">...</a></li><li class="pagination__item pagination__item--last"><a class="btn btn-sm btn btn-outline" href=/tags/powercli/page/3/>3</a></li></ul></nav></div><nav class="sidenav clr-col-2 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6"><section class=sidenav-content><div class=card><div class=card-block><div class=card-text id=site-intro><img src=/images/me2-300.png><p>a blog about virtualization and stuff<ul class=nav-list-inline><a href=//github.com/dstamen target=_blank rel=noopener title=GitHub class="fab fa-github"></a><a href=//linkedin.com/in/davidstamen target=_blank rel=noopener title=LinkedIn class="fab fa-linkedin"></a><a href=//twitter.com/davidstamen target=_blank rel=noopener title=Twitter class="fab fa-twitter"></a><a href=mailto:dstamen@gmail.com target=_blank title=Email class="fas fa-envelope"></a><a href=/tags/powercli/index.xml type=application/rss+xml target=_blank title=RSS class="fas fa-rss"></a></ul></div></div></div><div class=card><div class=card-header><b>Latest Posts</b></div><div class=card-block><div class=card-text><ul class=list style=list-style-type:square;list-style-position:inherit><li><a class=nav-list href=https://davidstamen.com/deploying-tkg-on-vmc/>Deploying Tanzu Kubernetes Grid (TKG) on VMware Cloud on AWS (VMC)</a></li><li><a class=nav-list href=https://davidstamen.com/deploying-tkg-on-vsphere/>Deploying Tanzu Kubernetes Grid (TKG) on vSphere</a></li><li><a class=nav-list href=https://davidstamen.com/2020/04/24/whats-new-in-the-pure-storage-vrealize-operations-management-pack-3.0/>What's New in the Pure Storage vRealize Operations Management Pack 3.0</a></li><li><a class=nav-list href=https://davidstamen.com/2020/04/21/whats-new-in-the-4.3.0-pure-storage-vsphere-client-plugin/>What's New in the 4.3.0 Pure Storage vSphere Client Plugin</a></li><li><a class=nav-list href=https://davidstamen.com/2020/04/16/using-powercli-to-deploy-the-site-recovery-manager-8.3-appliance/>Using PowerCLI to Deploy the Site Recovery Manager 8.3 Appliance</a></li></ul></div></div></div><div class=card><div class=card-header><b>Advertisements</b></div><div class=card-block><div class=card-text align=center><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:inline-block;width:180px;height:150px data-ad-client=ca-pub-6907288179836979 data-ad-slot=6070718289></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></div></div></section></nav></div></div></body></html>
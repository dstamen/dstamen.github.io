<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>PowerCLI  &middot; davidstamen.com</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


  <meta name="description" content="" />

  <meta name="keywords" content="">




<meta property="og:type" content="website" />


  <link rel="canonical" href="https://davidstamen.com/tags/powercli/" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="icon" href="/favicon/favicon.ico">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6907288179836979",
    enable_page_level_ads: true
  });
</script>

  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    
    <script src="/js/clr-3.0/clr-icons.min.js"></script>
    <script src="/js/clr-3.0/custom-elements.min.js"></script>

    
    <link href="/css/clr-3.0/clr-ui.css" rel="stylesheet">
    
    <link href="/css/clr-3.0/clr-icons.min.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/all.css">
</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
  <div class="main-container">
    
<header class="header-2">
  <div class="branding">
    

    
    <a class="navbar-brand-img" href="/">
      <img alt="" src="">
      <span class="title">davidstamen.com</span>
      
    </a>
  </div>
  <div class="header-nav" [clr-nav-level]="1">
    
    
        <a class="nav-link  nav-text" href="https://davidstamen.com/" title="Home">
          
          Home
        </a>
    
        <a class="nav-link  nav-text" href="https://davidstamen.com/categories/pure-storage/" title="Pure Storage">
          
          Pure Storage
        </a>
    
        <a class="nav-link  nav-text" href="https://davidstamen.com/categories/vmware/" title="VMware">
          
          VMware
        </a>
    
        <a class="nav-link  nav-text" href="https://davidstamen.com/tags/" title="Tags">
          
          Tags
        </a>
    
        <a class="nav-link  nav-text" href="https://davidstamen.com/series/" title="Series">
          
          Series
        </a>
    
        <a class="nav-link  nav-text" href="https://www.youracclaim.com/users/davidstamen" title="Acclaim">
          
          Acclaim
        </a>
    
        <a class="nav-link  nav-text" href="https://davidstamen.com/about" title="About">
          
          About
        </a>
    
  </div>
  <div class="header-actions">
  <form class="search" id="search" method="get" action="//google.com/search">
    <label for="search_input">
        <input id="search_input" type="text" name="q" placeholder="Search">
        <input type="hidden" name="as_sitesearch" value="davidstamen.com">
    </label>
</form>
</div>
</header>


<div class="content-container">
  <div class="content-area">
    <h1>PowerCLI
</h1>

    <div class="clr-row">
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2020/03/03/installing-and-updating-the-pure-storage-vsphere-plugin/">Installing and Updating the Pure Storage vSphere Plugin</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        
                        Published on 
March 3, 2020 under <a class="" href="/categories/pure-storage">Pure Storage</a> and <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="https://davidstamen.com/featured/purestorage.png" class="clr-card-featured-image"> 
                    
  
    Welcome to the first of many Pure Storage blogs. As I get ramped up with the latest information I plan to do a series of getting started with Pure Storage features. These blogs will cover things such as the vSphere Client (HTML5) Plugin, FlashArray, FlashBlade and integrations with other VMware products. First up is learning to install and update the Pure Storage vSphere Client Plugin.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/vsphere-plugin">vSphere Plugin</a>, <a class="" href="/tags/vcenter-server">vCenter Server</a>, <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2017/07/27/using-powercli-to-add-vrealize-operations-license-key/">Using PowerCLI to Add vRealize Operations License Key</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
July 27, 2017 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    I have been working on doing a vCenter Consolidation Project. This included migrating our systems to a new vRealize Operations Server. This particular one included 73 different vSOM keys, and as you may know there is currently no way to enter in multiple keys at a time. I reached out to Kyle Ruddy and he informed me there is an API to do this, and that started my adventure to get this working.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/vrops">vROPS</a> and <a class="" href="/tags/powercli">PowerCLI</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2017/04/17/using-powercli-to-set-vcenter-permissions-on-datacenter/">Using PowerCLI to Set vCenter Permissions on Datacenter</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
April 17, 2017 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    I have been working on doing a vCenter Consolidation Project. This has meant recreating multiple permissions groups. I couldnt find an easy way to apply permissions at a datacenter so I updated this script to be used.
Pre-Requsites   VMware PowerCLI  Link to Script   Set-vCenterPermissions.ps1  permissions.csv  Preparing to Execute the Script The script is pretty straight forward, just need to update columns in the CSV such as Datacenter, Group and Role.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/vcenter-server">vCenter Server</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2016/04/21/using-powercli-to-get-and-set-dvs-traffic-shaping-settings/">Using PowerCLI to Get and Set DVS Traffic Shaping Settings</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
April 21, 2016 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    I have been in process in configuring traffic shaping for multiple port groups. It seems with PowerCLI 6.3 R1 there are no native Powershell Cmdlets. Luckily I stumbled across @Lucd and his PowerCLI functions to manage these settings, i have put these into a script to mass get and set the settings for all port groups of a DVS’s.
Pre-Requsites   VMware PowerCLI  Link to Script   Get-VMwareTrafficShapingSettings.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/networking">Networking</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2016/03/03/using-powercli-to-install-host-vibs/">Using PowerCLI to Install Host VIBs</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
March 3, 2016 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    So currently Cisco has an issue with installing their ENIC and FNIC VIBs through Update Manager for ESXi 6.x. Until that is resolved I need to manually push out patches to these hosts. Obviously I do not want to do this manually, so I will be utilizing PowerCLI to accomplish this task.
Pre-Requsites   VMware PowerCLI  Link to Script   Install-HostVIB.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/esxi">ESXi</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2016/01/29/using-powercli-to-install-software-in-a-guest-vm/">Using PowerCLI to Install Software in a Guest VM</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 29, 2016 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    I have been constantly trying to figure out the best way to deploy updated agents to some of our virtual desktops. It isnt a large environment so I have no need for SCCM or other deployment tools, but its big enough having to RDP to each VM was a pain. I finally decided to bang out a script, and surprised how well it works.
Pre-Requsites   VMware PowerCLI  Link to Script   InstallVMSoftware.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2016/01/26/using-powercli-to-replicate-templates-to-multiple-clusters/">Using PowerCLI to Replicate Templates to Multiple Clusters</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 26, 2016 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    We have multiple clusters within our vCenters that are defined as a rack. Each rack has its own storage, so storage is not shared between clusters. I needed to develop a way to easily replicate templates between clusters, so a local copy existed on each cluster to take advantage of VAAI.
I really wanted to utilize the vSphere Content Libary for these, but there is currently no publicly available documentation on how to deploy a VM from a Content Library via a Script.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2016/01/13/unable-to-boot-efi-vm-on-esxi-fc-storage/">Unable to Boot EFI VM on ESXi FC Storage</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 13, 2016 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    For the past week, I have been troubleshooting the strangest issue. I have been attempting to move some Windows 8.1 VM’s from our legacy datacenter(iSCSI) to our new datacenter(FC).
Whenever I would move the VM to our new DC, it would fail to boot properly. It would boot straight to Windows Recovery. If I moved the same VM to any other type of storage(NFS, iSCSI, Local) the VM would boot perfectly fine.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/storage">Storage</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2015/11/30/installing-host-vibs-using-powercli/">Installing Host VIB&#39;s Using PowerCLI</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
November 30, 2015 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    Normally when i need to install and update a host VIB I use Update Manager. However there is currently a bug with Cisco’s latest enic/fnic drivers that wont let you install them via UM.
I had to run these updates on over 50 hosts and I really didn’t want to have to ssh and install it manually. Lucky I remember Brian Graf&amp;rsquo;s Host Client Install Fling and borrowed some of the code to come up with the below script.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/powercli">PowerCLI</a> and <a class="" href="/tags/esxi">ESXi</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="https://davidstamen.com/2015/11/18/disconnected-vnics/">Disconnected vNIC&#39;s?</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
November 18, 2015 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    Ever wonder why a VM isn’t on the network?
I was working on deploying some test VM’s and for some reason all the VM’s that were cloned decided to start with the network disconnected, and the connect on power on was also not selected.
I decided to throw together this quick one-liner that will make sure every VM is set to start connected on power on and is currently connected.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/networking">Networking</a> and <a class="" href="/tags/powercli">PowerCLI</a>
        </div>
    </div>
</div>
    
    </div>
    
<nav>
    
















  <ul class="pagination">
    
    
    

    
    

    
    
    
      

      
      
      

        

      

      
      
        <li class="pagination__item pagination__item--current">
          <a href="/tags/powercli/" class="btn btn-sm  btn btn-primary ">
            1
          </a>
        </li>
      

    
    
      

      
      
      

        

      

      
      
        <li class="pagination__item">
          <a href="/tags/powercli/page/2/" class="btn btn-sm  btn btn-outline">
            2
          </a>
        </li>
      

    
    
      

      
      
      

        

      

      
      
        <li class="pagination__item">
          <a href="/tags/powercli/page/3/" class="btn btn-sm  btn btn-outline">
            3
          </a>
        </li>
      

    

    
    
    <li class="pagination__item pagination__item--next">
      <a href="/tags/powercli/page/2/" class="btn btn-sm btn-outline">
        ...
      </a>
    </li>
    

    
    
    <li class="pagination__item pagination__item--last">
      <a class="btn btn-sm btn btn-outline" href="/tags/powercli/page/3/">
        3
      </a>
    </li>
    

  </ul>

</nav>


  </div>
  
    <nav class="sidenav clr-col-2 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6">
  <section class="sidenav-content">
    
    
    
    <div class="card">
    <div class="card-block">
    <div class="card-text" id="site-intro">
      <img src="/images/me2-300.png">
        <p>a blog about virtualization and stuff
        
        <ul class="nav-list-inline">
          <a href="//github.com/dstamen" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a>











<a href="//linkedin.com/in/davidstamen" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a>















<a href="//twitter.com/davidstamen" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a>








<a href="mailto:dstamen@gmail.com" target="_blank" title="Email" class="fas fa-envelope"></a>

          
    <a href="/tags/powercli/index.xml" type="application/rss+xml" target="_blank" title="RSS" class="fas fa-rss"></a>


        </ul>
        
    </div>
    </div>
    </div>
    <div class="card">
    <div class="card-header">
      <b>Latest Posts</b>
    </div>
  <div class="card-block">
    <div class="card-text">
      <ul class="list" style="list-style-type:square;list-style-position:inherit">
        
        <li><a class="nav-list" href="https://davidstamen.com/2020/03/05/using-the-pure-storage-vsphere-plugin/">Using the Pure Storage vSphere Plugin</a></li>
        
        <li><a class="nav-list" href="https://davidstamen.com/2020/03/03/installing-and-updating-the-pure-storage-vsphere-plugin/">Installing and Updating the Pure Storage vSphere Plugin</a></li>
        
        <li><a class="nav-list" href="https://davidstamen.com/2020/02/24/vexpert-2020/">vExpert 2020</a></li>
        
        <li><a class="nav-list" href="https://davidstamen.com/2020/02/12/back-to-work-im-going-to/">Back to Work, I&#39;m Going to</a></li>
        
        <li><a class="nav-list" href="https://davidstamen.com/2020/01/13/my-certified-kubernetes-administrator-cka-exam-experience/">My Certified Kubernetes Administrator (CKA) Exam Experience</a></li>
        
      </ul>
    </div>
  </div>
</div>
<div class="card">
  <div class="card-header">
    <b>Advertisements</b>
  </div>
<div class="card-block">
  <div class="card-text" align="center">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<ins class="adsbygoogle"
     style="display:inline-block;width:180px;height:150px"
     data-ad-client="ca-pub-6907288179836979"
     data-ad-slot="6070718289"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
  </div>
</div>
</div>

</section>
</nav>
  
</div>
      
    </div>
  </body>
</html>


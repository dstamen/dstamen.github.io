<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Storage on davidstamen</title><link>https://davidstamen.com/tags/storage/</link><description>Recent content in Storage on davidstamen</description><generator>Hugo</generator><language>en</language><copyright>Copyright © 2008–2018, Steve Francia and the Hugo Authors; all rights reserved.</copyright><lastBuildDate>Mon, 02 May 2022 12:00:00 +0000</lastBuildDate><atom:link href="https://davidstamen.com/tags/storage/index.xml" rel="self" type="application/rss+xml"/><item><title>Understanding Block Storage in Amazon Web Services</title><link>https://davidstamen.com/2022/05/02/understanding-block-storage-in-amazon-web-services/</link><pubDate>Mon, 02 May 2022 12:00:00 +0000</pubDate><guid>https://davidstamen.com/2022/05/02/understanding-block-storage-in-amazon-web-services/</guid><description>&lt;p&gt;When running workloads in the Public Cloud such as Amazon Web Services, you have a bunch of options when it comes to block storage. How do you know which one to pick? There are alot of choices&amp;ndash;tradeoffs, features and sprawl can also occur. In this blog I will cover the different types of disks available to help educate you on some of the purposes and limitations of each. I previously covered what this looks like in Microsoft Azure and figured now would be a good time to cover the differences in AWS.&lt;/p&gt;</description></item><item><title>Understanding Block Storage in Microsoft Azure</title><link>https://davidstamen.com/2022/04/29/understanding-block-storage-in-microsoft-azure/</link><pubDate>Fri, 29 Apr 2022 12:00:00 +0000</pubDate><guid>https://davidstamen.com/2022/04/29/understanding-block-storage-in-microsoft-azure/</guid><description>&lt;p&gt;When running workloads in the Public Cloud such as Microsoft Azure, you have a bunch of options when it comes to block storage. How do you know which one to pick? There are alot of choices&amp;ndash;tradeoffs, features and sprawl can also occur. In this blog I will cover the different types of disks available to help educate you on some of the purposes and limitations of each.&lt;/p&gt;</description></item><item><title>Automating Migration of VMFS-5 to VMFS-6 Datastores</title><link>https://davidstamen.com/2018/10/07/automating-migration-of-vmfs-5-to-vmfs-6-datastores/</link><pubDate>Sun, 07 Oct 2018 08:13:29 -0400</pubDate><guid>https://davidstamen.com/2018/10/07/automating-migration-of-vmfs-5-to-vmfs-6-datastores/</guid><description>&lt;p&gt;Next up in our Automating your vSphere Upgrade blog series is your VMFS Datastore. vSphere 6.5 and vSphere 6.7 both support the latest VMFS-6. Once all of your ESXi hosts that are connected to the VMFS-5 datastore have been upgraded to vSphere 6.5 or vSphere 6.7 you can then proceed to migrate your datastore to VMFS-6.&lt;/p&gt;</description></item><item><title>Reconfigure HA - The object 'vim.Datastore:datastore-XXXX' has already been deleted or has not been completely created</title><link>https://davidstamen.com/2018/01/19/reconfigure-ha-the-object-vim.datastoredatastore-xxxx-has-already-been-deleted-or-has-not-been-completely-created/</link><pubDate>Fri, 19 Jan 2018 10:27:02 +0000</pubDate><guid>https://davidstamen.com/2018/01/19/reconfigure-ha-the-object-vim.datastoredatastore-xxxx-has-already-been-deleted-or-has-not-been-completely-created/</guid><description>&lt;p&gt;Another lovely Friday starting off with strange issues, when taking a host out of standard maintenance we noticed that HA would not reconfigure, and kept saying &lt;em&gt;The object &amp;lsquo;vim.Datastore:datastore-1131&amp;rsquo; has already been deleted or has not been completely created.&lt;/em&gt; This was strange because no other hosts had this issue.



 
 
 
 
 
 
 
 
 

 
 







 



 
 
 
 
 &lt;script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"&gt;&lt;/script&gt;
 &lt;link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" /&gt;
 &lt;script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"&gt;&lt;/script&gt;

 &lt;div style="max-width: 80%;width: fit-content;margin: auto;padding: 1.5em;"&gt;
 &lt;a data-fancybox="gallery" href="https://davidstamen.com/images/screenshot-2018-01-19%2010-23-44.png" data-caption="caption"&gt;&lt;img width=100% src="https://davidstamen.com/images/screenshot-2018-01-19%2010-23-44.png"&gt;&lt;/a&gt;
 
 &lt;/div&gt;
 

&lt;/p&gt;
&lt;p&gt;I proceeded to follow standard troubleshooting steps, reconfigure HA&amp;hellip;same issue&amp;hellip;.disable HA for entire cluster and re-enable&amp;hellip;..same issue&amp;hellip;whoops thats not good!&lt;/p&gt;</description></item><item><title>Unable to Boot EFI VM on ESXi FC Storage</title><link>https://davidstamen.com/2016/01/13/unable-to-boot-efi-vm-on-esxi-fc-storage/</link><pubDate>Wed, 13 Jan 2016 00:00:00 +0000</pubDate><guid>https://davidstamen.com/2016/01/13/unable-to-boot-efi-vm-on-esxi-fc-storage/</guid><description>&lt;p&gt;For the past week, I have been troubleshooting the strangest issue. I have been attempting to move some Windows 8.1 VM&amp;rsquo;s from our legacy datacenter(iSCSI) to our new datacenter(FC).&lt;/p&gt;
&lt;p&gt;Whenever I would move the VM to our new DC, it would fail to boot properly. It would boot straight to Windows Recovery. If I moved the same VM to any other type of storage(NFS, iSCSI, Local) the VM would boot perfectly fine. I opened a case with VMware and our Storage vendor and no one had any idea what was causing it.&lt;/p&gt;</description></item><item><title>Using PowerCLI to Extend VMDK and Windows OS Disk</title><link>https://davidstamen.com/2015/09/15/using-powercli-to-extend-vmdk-and-windows-os-disk/</link><pubDate>Tue, 15 Sep 2015 00:00:00 +0000</pubDate><guid>https://davidstamen.com/2015/09/15/using-powercli-to-extend-vmdk-and-windows-os-disk/</guid><description>&lt;p&gt;I wanted to share this handy script i created when you have a need to extend a disk.&lt;/p&gt;
&lt;p&gt;This script can be extremely handy as it will take care of extending the VMDK and then going to the OS and then performing the expansion there as well. This has been helpful when needing to extend a large batch of servers (60+).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Syntax:&lt;/strong&gt; .\ExtendVMDKandGuest VMNAME&lt;/p&gt;
&lt;p&gt;You will then be prompted to enter in the Hard Disk #, the size you want to be extended, and then which drive letter that volume belongs to.&lt;/p&gt;</description></item><item><title>Using PowerCLI to Detach Luns</title><link>https://davidstamen.com/2015/09/14/using-powercli-to-detach-luns/</link><pubDate>Mon, 14 Sep 2015 00:00:00 +0000</pubDate><guid>https://davidstamen.com/2015/09/14/using-powercli-to-detach-luns/</guid><description>&lt;p&gt;I thought I would share this script, its been circulating a bit but I feel it is a nice one to have in your toolkit.&lt;/p&gt;
&lt;p&gt;Have you ever had to remove a LUN from a cluster and thought &amp;ldquo;Do I really need to detach all the LUN&amp;rsquo;s, before un-mapping from my SAN?&amp;rdquo;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Unmount Datastore&lt;/li&gt;
&lt;li&gt;Detach LUN&lt;/li&gt;
&lt;li&gt;Un-map from SAN&lt;/li&gt;
&lt;li&gt;Rescan Cluster&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Well here is a handy script with output. All you need to do is unmount your datastore(s), and then enter in your naaid of your LUN&amp;rsquo;s and the cluster you want to remove it from, save it an execute. All the LUN&amp;rsquo;s will be detached without having to manually go and detach it from every LUN in your cluster.&lt;/p&gt;</description></item><item><title>PowerCLI - Extend VMDK and Guest OS</title><link>https://davidstamen.com/2015/04/02/powercli-extend-vmdk-and-guest-os/</link><pubDate>Thu, 02 Apr 2015 00:00:00 +0000</pubDate><guid>https://davidstamen.com/2015/04/02/powercli-extend-vmdk-and-guest-os/</guid><description>&lt;p&gt;So as always things change across multiple Window&amp;rsquo;s operating systems and VMware revisions. I had a need to extend the drives on about 50 VMs today and really didn&amp;rsquo;t want to do all that clicking. I remember awhile back it was easy to do this with a Basic Set-Harddisk and use the -ResizeGuestPartition but alas that has been removed from the current functionality. So I took my search to google and found a couple scripts that worked ok, but nothing that was a seamless experience.&lt;/p&gt;</description></item><item><title>Create VMFS Datastore Using PowerCLI</title><link>https://davidstamen.com/2014/05/22/create-vmfs-datastore-using-powercli/</link><pubDate>Thu, 22 May 2014 00:00:00 +0000</pubDate><guid>https://davidstamen.com/2014/05/22/create-vmfs-datastore-using-powercli/</guid><description>&lt;p&gt;For upcoming testing there was a need to create 140 datastores on a cluster for testing. Who wants to do that much clicking and typing? Not me!
You can use the below PowerCLI commands to get the SCSI ID&amp;rsquo;s,  Create the Datastore and then Rescan all hosts in the cluster.&lt;/p&gt;
&lt;h2 id="how-do-i-get-the-canonicalname-for-allocated-disks"&gt;How do i get the CanonicalName for allocated disks?&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="ln"&gt;1&lt;/span&gt;&lt;span class="cl"&gt;Get-SCSILun -VMhost 192.168.1.103 -LunType Disk | Select CanonicalName,Capacity
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="how-do-i-create-a-vmfs-datastore-for-the-canonicalname-i-identified-above"&gt;How do I create a VMFS datastore for the CanonicalName I identified above?&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="ln"&gt;1&lt;/span&gt;&lt;span class="cl"&gt;New-Datastore -VMHost Host -Name Datastore -Path CanonicalName -VMFS
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="how-do-i-rescan-all-the-hosts-in-the-cluster-to-see-the-new-datastore"&gt;How do i rescan all the hosts in the cluster to see the new datastore?&lt;br /&gt;&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="ln"&gt;1&lt;/span&gt;&lt;span class="cl"&gt;Get-Cluster -name Cluster | Get-VMhost | Get-VMHostStorage -RescanAllHBA
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>vSphere 5.x Storage vMotion Does Not Rename Virtual Machine Files.</title><link>https://davidstamen.com/2014/05/21/vsphere-5-x-storage-vmotion-does-not-rename-virtual-machine-files/</link><pubDate>Wed, 21 May 2014 00:00:00 +0000</pubDate><guid>https://davidstamen.com/2014/05/21/vsphere-5-x-storage-vmotion-does-not-rename-virtual-machine-files/</guid><description>&lt;p&gt;After upgrading vCenter this functionality is no longer enabled by default. Please perform the following steps to enable rename of files upon successful Storage vMotion.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Log into the vSphere Client as an Administrator&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Administration &amp;gt; vCenter Server Settings&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Advanced Settings&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Add this advanced parameter key:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;provisioning.relocate.enableRename&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="5"&gt;
&lt;li&gt;Set the value to: &lt;strong&gt;true&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Add&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;OK&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Restart the VMware VirtualCenter Server service for the changes to take effect&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>HA Error: Datastore Heartbeat is less than 2</title><link>https://davidstamen.com/2014/05/08/ha-error-datastore-heartbeat-is-less-than-2/</link><pubDate>Thu, 08 May 2014 00:00:00 +0000</pubDate><guid>https://davidstamen.com/2014/05/08/ha-error-datastore-heartbeat-is-less-than-2/</guid><description>&lt;p&gt;If you are configuring a cluster with less than 2 datastores, you will receive an HA warning &amp;ldquo;The number of heartbeat datastores for host is 1, which is less than required: 2&amp;rdquo; You can add an option to the HA Advanced Options to supress this warning.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Log in to vCenter Server&lt;/li&gt;
&lt;li&gt;Right-click the cluster and click &lt;strong&gt;Edit Settings&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click vSphere &lt;strong&gt;HA &amp;gt; Advanced Options&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Under Option, add an entry for &lt;strong&gt;das.ignoreInsufficientHbDatastore&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Under Value, type &lt;strong&gt;true&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Cluster Features&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;De-select &lt;strong&gt;Turn on vSphere HA&lt;/strong&gt; and click &lt;strong&gt;OK&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Wait for all the hosts in the cluster to re-configure HA, then right-click the cluster and click &lt;strong&gt;Edit Settings&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Cluster Features&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;Turn on vSphere HA&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Click &lt;strong&gt;OK&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>Get NAA.ID for Virtual Machine RDM's in VMware</title><link>https://davidstamen.com/2014/05/06/get-naa-id-for-virtual-machine-rdms-in-vmware/</link><pubDate>Tue, 06 May 2014 00:00:00 +0000</pubDate><guid>https://davidstamen.com/2014/05/06/get-naa-id-for-virtual-machine-rdms-in-vmware/</guid><description>&lt;p&gt;This is a great script to keep handy. If you have multiple RDM&amp;rsquo;s on a VM and need to get the NAA_ID for them the below PowerCLI command will get you that information.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="ln"&gt;1&lt;/span&gt;&lt;span class="cl"&gt;Get-VM VMNAME| Get-HardDisk -DiskType &amp;#34;RawPhysical&amp;#34;,&amp;#34;RawVirtual&amp;#34; | Select Parent,Name,DiskType,ScsiCanonicalName,DeviceName,CapacityGB | fl
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="https://davidstamen.com/images/naaid.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;If you then need to match the SCSI virtual disk to the Guest OS this is a great article on how to do so.&lt;/p&gt;
&lt;p&gt;&lt;a href="http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;amp;docType=kc&amp;amp;externalId=2051606"&gt;KB2051606&lt;/a&gt;&lt;/p&gt;</description></item></channel></rss>
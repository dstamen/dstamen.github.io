<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Powershell  &middot; davidstamen.com</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


  <meta name="description" content="" />

  <meta name="keywords" content="">




<meta property="og:type" content="website" />


  <link rel="canonical" href="/tags/powershell/" />
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="icon" href="/favicon/favicon.ico">


  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    
    <script src="/js/clr-1.0/clr-icons.min.js"></script>
    <script src="/js/clr-1.0/custom-elements.min.js"></script>

    
    <link href="/css/clr-1.0/clr-ui.css" rel="stylesheet">
    
    <link href="/css/clr-1.0/clr-icons.min.css" rel="stylesheet">
    <link href="/css/custom.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/all.css">




</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
  <div class="main-container">
    
<header class="header-7">
  <div class="branding">
    

    
    <a class="navbar-brand-img" href="/">
      <img alt="" src="">
      <span class="title">davidstamen.com</span>
      
    </a>
  </div>
  <div class="header-nav" [clr-nav-level]="1">
    
    
        <a class="nav-link  nav-text" href="/" >
          
          Home
        </a>
    
        <a class="nav-link  nav-text" href="/tags/" >
          
          Tags
        </a>
    
        <a class="nav-link  nav-text" href="/categories/" >
          
          Categories
        </a>
    
        <a class="nav-link  nav-text" href="/series/" >
          
          Series
        </a>
    
        <a class="nav-link  nav-text" href="/acclaim" >
          
          Acclaim
        </a>
    
        <a class="nav-link  nav-text" href="/about" >
          
          About
        </a>
    
  </div>
  <div class="header-actions">
  <form class="search" id="search" method="get" action="//google.com/search">
    <label for="search_input">
        <input id="search_input" type="text" name="q" placeholder="Search">
        <input type="hidden" name="as_sitesearch" value="davidstamen.com">
    </label>
</form>
</div>
</header>
<nav class="subnav" [clr-nav-level]="2">
  <ul class="nav">
    
    
    <li class="nav-item">
        <a class="nav-link " href="/vcsa-json-creator" >
          
          VCSA JSON Creator 9000
        </a>
    </li>
    
  </ul>
</nav>


<div class="content-container">
  <div class="content-area">
    <h1>Powershell
</h1>

    <div class="clr-row">
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2019/01/31/patching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module/">Patching the vCenter Server Appliance (VCSA) using the REST API - Part 2 (PowerCLI Module)</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 31, 2019 under <a class="" href="/categories/vmware">VMware</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                     <img src="/featured/powercli.png" class="clr-card-featured-image"> 
                    
  
    Previously I covered how to use the VCSA Installer to do a scripted upgrade and then I covered Patching the vCenter Server Appliance (VCSA) using the REST API - Part 1 (Postman Collection) However, after learning recently how to call API’s from Powershell I thought to myself, why not write a Powershell Module for this?
Introduction Using tools such as Postman can make it utilizing API’s a bit easier, but you still need to be familiar with a separate tool or UI.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/vsphere-6.7">vSphere 6.7</a>, <a class="" href="/tags/rest-api">REST API</a>, <a class="" href="/tags/vcenter-server">vCenter Server</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2016/08/09/using-powershell-to-create-windows-smb-shares/">Using Powershell to Create Windows SMB Shares</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
August 9, 2016 under <a class="" href="/categories/microsoft">Microsoft</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    I have been knee deep in migrations, so after clicking through a few times to create clustered file shares, I finally decided to script them. Here is that script I thought I would share. Thanksfully there was the NTFSSecurity module published by microsoft that makes permissions a breeze. You can get more details by viewing the module page.
Pre-Requsites  NTFS Security Module  Link to Script  Create-SMBShare.ps1  Preparing to Execute the Script Fill in the appropriate variables, and execute the script.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/windows">Windows</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2016/04/18/using-veeam-powershell-to-manage-reip-rules/">Using Veeam Powershell to Manage ReIP Rules</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
April 18, 2016 under <a class="" href="/categories/backup">Backup</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    Hello! Welcome to my First Veeam PowerShell Script! I have been working on tons of migrations using Veeam Backup and Replication and need to create re-ip rules to update the static IP assignments. Obviously the first rule of scripting if you do something more than once, automate! I was bad at this one, I originally tried and gave up so I did about 20 manually which started to become a huge headache.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/veeam">Veeam</a>, <a class="" href="/tags/powershell">Powershell</a> and <a class="" href="/tags/availability">Availability</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2016/03/14/using-ucs-powertool-to-configure-syslog-servers/">Using UCS PowerTool to Configure Syslog Servers</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
March 14, 2016 under <a class="" href="/categories/cisco">Cisco</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    Time for more UCS Scripting! This time to configure Syslog. The script is pretty straightforward, but nice to have to easily set up Syslog across multiple UCS domains.
Pre-Requsites  UCS Powertool  Link to Script  Set-UcsSyslog.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script. I will walk you through the process.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/cisco-ucs">Cisco UCS</a>, <a class="" href="/tags/syslog">Syslog</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2016/03/01/using-ucs-powertool-to-set-snmp-configuration/">Using UCS PowerTool To Set SNMP Configuration</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
March 1, 2016 under <a class="" href="/categories/cisco">Cisco</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    Time for more UCS Scripting! This time to enable SNMP. The script is pretty straightforward, but nice to have to easily set up SNMP across multiple UCS domains.
Pre-Requsites  UCS Powertool  Link to Script  Set-UcsSnmpConfiguration.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script. I will walk you through the process.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/cisco-ucs">Cisco UCS</a>, <a class="" href="/tags/snmp">SNMP</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2016/02/04/using-ansible-to-run-powershell-scripts/">Using Ansible to Run Powershell Scripts</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
February 4, 2016 under <a class="" href="/categories/automation">Automation</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    In the midst of playing with Ansible and figured my most common use case would be executing powershell scripts on remote servers, so scavenged around and put this together.
Pre-Requsites  ansible ansible-winrm  Link to Git Project  ansible_powershell  Preparing to Execute the Script This script assumes you have already installed and configured Ansible, downloaded the Git Repo and installed the WinRM python module.
Define your group variables.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/ansible">Ansible</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2016/01/15/using-ucs-powertool-to-set-equipment-labels/">Using UCS PowerTool To Set Equipment Labels</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 15, 2016 under <a class="" href="/categories/cisco">Cisco</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    For conformity, we like to set the UCS Equipment labels to match the Service Profile Name. This allows us to match it quickly without having to dig down into the assigned profile. This script will set the UsrLbl and Name fields on the equipment tab to match the name of the Service Profile.
Pre-Requsites  UCS Powertool  Link to Script  Set-UCSEquipmentLabel.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/cisco-ucs">Cisco UCS</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2016/01/14/using-ucs-powertool-to-generate-tech-supports/">Using UCS PowerTool To Generate Tech Supports</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 14, 2016 under <a class="" href="/categories/cisco">Cisco</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    Automation, Automation, Automation! I had to download some support bundles for every chassis in our multiple zones. Instead of manually going through the GUI, I figured why not script it! This script will connect to each UCS domain and automatically generate a support bundle and download it for each chassis.
Pre-Requsites  UCS Powertool  Link to Script  Create-UCSTechSupport.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/cisco-ucs">Cisco UCS</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2016/01/11/using-ucs-powertool-to-upload-ucs-firmware/">Using UCS PowerTool To Upload UCS Firmware</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
January 11, 2016 under <a class="" href="/categories/cisco">Cisco</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    It’s patch time! That means time to upload the firmware bundles to all my UCS domains. Instead of doing it manually I figured i would create a quick script to do that for me.
Pre-Requsites  UCS Powertool  Link to Script  UploadUCSFirmware.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/cisco-ucs">Cisco UCS</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
      <div class="clr-col-12">
    <div class="card">
        <div class="card-header">
            <a href="/2015/12/11/using-ucs-powertool-to-configure-ucs-policy-backup-and-export/">Using UCS PowerTool To Configure UCS Policy Backup and Export</a>
        </div>
        <div class="card-block">
            <div class="card-media-block">
                <div class="card-media-desciption clr-card-authors">
                    <span class="card-media-title clr-card-authors">
                        <div class="clr-card-authors">
                        Published on 
December 11, 2015 under <a class="" href="/categories/cisco">Cisco</a>
                        </div>
                    </span>
                </div>
            </div>
        </div>
        <div class="card-block">
            <div class="card-text" style="max-height: 100px; min-height: 100px; overflow: hidden;">
                    
                    
  
    Im finally getting to dive back in to working with UCS. My latest task with my project of configuring 9 UCS Domains, was configuring the Policy Backup and Export. See below on how to automate this process!
Pre-Requsites  UCS Powertool  Link to Script  Set-UCSPolicyBackupandExport.ps1  Preparing to Execute the Script The script is pretty straight forward, just need to define a few variables seen below and then you execute the script.
  



            </div>
        </div>
        <div class="card-footer">
            
            Tagged <a class="" href="/tags/cisco-ucs">Cisco UCS</a> and <a class="" href="/tags/powershell">Powershell</a>
        </div>
    </div>
</div>
    
    </div>
    
<nav>
  <ul class="pagination">
    
















  <ul class="pagination">
    
    
    

    
    

    
    
    
      

      
      
      

        

      

      
      
        <li class="pagination__item pagination__item--current">
          <a href="/tags/powershell/" class="btn btn-sm  btn btn-primary ">
            1
          </a>
        </li>
      

    
    
      

      
      
      

        

      

      
      
        <li class="pagination__item">
          <a href="/tags/powershell/page/2/" class="btn btn-sm  btn btn-outline">
            2
          </a>
        </li>
      

    

    
    
    <li class="pagination__item pagination__item--next">
      <a href="/tags/powershell/page/2/" class="btn btn-sm btn-outline">
        ...
      </a>
    </li>
    

    
    
    <li class="pagination__item pagination__item--last">
      <a class="btn btn-sm btn btn-outline" href="/tags/powershell/page/2/">
        2
      </a>
    </li>
    

  </ul>

  </ul>
</nav>


  </div>
  
    <nav class="sidenav clr-col-2 clr-col-sm-12 clr-col-md-12 clr-col-lg-6 clr-col-xl-6">
  <section class="sidenav-content">
    
    
    
    <div class="card">
    <div class="card-block">
    <div class="card-text" id="site-intro">
      <img src="/images/me2-300.png">
        <p>a blog about virtualization and stuff
        
        <ul class="nav-list-inline">
          <a href="//github.com/dstamen" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a>











<a href="//linkedin.com/in/davidstamen" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a>















<a href="//twitter.com/davidstamen" target="_blank" rel="noopener" title="Twitter" class="fab fa-twitter"></a>








<a href="mailto:dstamen@gmail.com" target="_blank" title="Email" class="fas fa-envelope"></a>

          
    <a href="/tags/powershell/index.xml" type="application/rss+xml" target="_blank" title="RSS" class="fas fa-rss"></a>


        </ul>
        
    </div>
    </div>
    </div>
    <div class="card">
    <div class="card-header">
      <b>Latest Posts</b>
    </div>
  <div class="card-block">
    <div class="card-text">
      <ul class="list" style="list-style-type:square;list-style-position:inherit">
        
        <li><a class="nav-list" href="/2019/06/07/vcenter-server-converge-tool-what-about-my-certificates/">vCenter Server Converge Tool - What About My Certificates</a></li>
        
        <li><a class="nav-list" href="/2019/04/24/vcenter-server-appliance-cli-json-creator/">vCenter Server Appliance CLI - JSON Creator</a></li>
        
        <li><a class="nav-list" href="/2019/04/11/vcenter-server-converge-tool-how-do-i-converge-an-environment-using-the-ui/">vCenter Server Converge Tool - How do I Converge an Environment Using the UI</a></li>
        
        <li><a class="nav-list" href="/2019/01/31/patching-the-vcenter-server-appliance-vcsa-using-the-rest-api-part-2-powershell-module/">Patching the vCenter Server Appliance (VCSA) using the REST API - Part 2 (PowerCLI Module)</a></li>
        
        <li><a class="nav-list" href="/2018/12/20/patching-the-vcenter-server-appliance-vcsa-using-the-rest-api/">Patching the vCenter Server Appliance (VCSA) using the REST API - Part 1 (Postman Collection)</a></li>
        
      </ul>
    </div>
  </div>
</div>
</section>
</nav>
  
</div>
      
    </div>
  </body>
</html>

